(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{4746:function(e,t,n){"use strict";var a=n(1),o=n.n(a),i=n(6),s=n(11),r=n(12),c=n(15),l=n(14),u=n(18),p=n(0),h=n.n(p),d=n(4),m=n(69),f=n(50),g=n(32),v=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement(g.default,{cardProps:{p:3,mt:3}},h.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(d.k,{size:"1.8em",name:"Input",color:"cellText"}),h.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Please connect with your wallet interact with Idle."),h.a.createElement(m.default,{buttonProps:{mt:2,width:[1,.5]},handleClick:this.props.connectAndValidateAccount},"Connect")))}}]),t}(p.Component);t.a=v},4754:function(e,t,n){"use strict";var a=n(36),o=n(35),i=n(1),s=n.n(i),r=n(6),c=n(11),l=n(12),u=n(15),p=n(14),h=n(18),d=n(0),m=n.n(d),f=n(144),g=n(163),v=n(138),b=n(69),k=n(50),x=n(261),C=n(202),y=n(32),w=n(355),E=n(4),S=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,tokenConfig:null,unevenAmounts:null,selectedToken:null,availableTokens:null,buttonDisabled:!1,showMaxSlippage:!1,redeemUnderlying:!0,curveTokenConfig:null,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,curveTokensAmounts:null,fastBalanceSelector:null,redeemUnevenAmounts:!1,curveRedeemableIdleTokens:null},n.functionsUtil=null,n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t;t=!e||e.gt(n.state.curveTokenBalance),n.setState({buttonDisabled:t})},n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new k.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.initToken();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showMaxSlippage",value:function(){this.setState({showMaxSlippage:!0})}},{key:"calculateSlippage",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t,n,a,i,r,c,l,u,p,h,d=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:null,(n=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)&&!n.lte(0)){e.next=4;break}return e.abrupt("return",!1);case 4:if(a=this.functionsUtil.normalizeTokenAmount(n,this.state.curvePoolContract.decimals),i=null,r=null,c=null,!this.state.redeemUnevenAmounts){e.next=20;break}return e.next=11,Promise.all([this.functionsUtil.getCurveTokensAmounts(this.props.account,a,!0),this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,a)]);case 11:return l=e.sent,u=Object(o.a)(l,2),r=u[0],c=u[1],e.next=17,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1,c);case 17:i=e.sent,e.next=29;break;case 20:return e.next=22,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1);case 22:return i=e.sent,e.next=25,this.functionsUtil.getCurveTokenPrice();case 25:p=e.sent,h=n.times(p).minus(n.times(i.times(100).plus(this.state.maxSlippage||this.functionsUtil.BNify(0)).div(100))),(r={})[this.state.selectedToken]=h;case 29:return i&&(i=i.times(100)),this.setState({withdrawSlippage:i,curveTokensAmounts:r,curveIdleTokensAmounts:c}),i&&t&&(i=i.plus(t)),e.abrupt("return",i);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(r.a)(s.a.mark(function e(t,n){var a,o,i,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),!(t.tokenConfig.idle.token!==this.props.tokenConfig.idle.token)){e.next=5;break}return e.next=5,this.initToken();case 5:a=n.redeemUnevenAmounts!==this.state.redeemUnevenAmounts,(this.state.fastBalanceSelector!==n.fastBalanceSelector||a)&&this.setInputValue(),o=n.inputValue!==this.state.inputValue,i=parseFloat(n.maxSlippage)!==parseFloat(this.state.maxSlippage),r=JSON.stringify(n.tokenConfig)!==JSON.stringify(this.state.tokenConfig),(o||r||i)&&this.calculateSlippage(),n.selectedToken!==this.state.selectedToken&&this.loadSelectedTokenConfig();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setInputValue",value:function(){if(null===this.state.fastBalanceSelector)return!1;var e,t=this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100);e=this.state.curveTokenBalance?this.functionsUtil.BNify(this.state.curveTokenBalance).times(t):null,this.checkButtonDisabled(e),this.setState({inputValue:e})}},{key:"selectDestinationToken",value:function(e){this.setState({selectedToken:e})}},{key:"loadSelectedTokenConfig",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.functionsUtil.getGlobalConfig(["curve"]),n=this.state.availableTokens[this.state.selectedToken],a=t.availableTokens[n.idle.token],this.setState({tokenConfig:n,curveTokenConfig:a});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t,n,a,i,r,c,l,u,p,h,d,m,f;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.functionsUtil.getCurvePoolContract(),this.functionsUtil.getCurveSwapContract()]);case 2:return t=e.sent,n=Object(o.a)(t,2),a=n[0],i=n[1],e.next=8,Promise.all([this.functionsUtil.getCurveTokenPrice(),this.functionsUtil.getCurveTokenBalance(this.props.account),this.functionsUtil.getCurveRedeemableIdleTokens(this.props.account)]);case 8:r=e.sent,c=Object(o.a)(r,3),l=c[0],u=c[1],p=c[2],h=[],d=u?u.times(l):this.functionsUtil.BNify(0),m=this.functionsUtil.getCurveAvailableTokens(),f=Object.keys(m)[0],this.setState({selectedToken:f,unevenAmounts:h,curveTokenPrice:l,availableTokens:m,curvePoolContract:a,curveSwapContract:i,curveTokenBalance:u,redeemableBalance:d,curveRedeemableIdleTokens:p});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redeem",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t,n,o,i,r,c,l,u,p,h,d,m=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.curveTokenBalance){e.next=2;break}return e.abrupt("return",!1);case 2:return t=function(e,t){var n="success"===e.status,a={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:m.props.selectedToken,eventValue:m.state.curveTokenBalance.toFixed()};t&&(a.eventLabel=m.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&m.functionsUtil.sendGoogleAnalyticsEvent(a),m.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof m.props.callbackRedeem&&n&&m.props.callbackRedeem(e)},n=function(e){var t=e.transactionHash;m.setState(function(e){return{processing:Object(a.a)({},e.processing,{txHash:t})}})},o=this.state.curveSwapContract.name,e.next=7,this.calculateSlippage(this.state.maxSlippage);case 7:if(i=e.sent,r=this.functionsUtil.BNify(this.state.maxSlippage).div(100),c=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null,l=this.functionsUtil.normalizeTokenAmount(c,this.state.curvePoolContract.decimals),!this.state.redeemUnevenAmounts){e.next=26;break}if(!this.state.redeemUnderlying){e.next=18;break}return e.next=15,this.functionsUtil.getCurveTokensAmounts(this.props.account,l,!1,!0);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,l,r);case 20:e.t0=e.sent;case 21:u=e.t0,console.log("remove_liquidity",l.toString(),u),this.props.contractMethodSendWrapper(o,"remove_liquidity",[l,u,this.state.redeemUnderlying],null,t,n),e.next=33;break;case 26:return p=this.state.curveTokenConfig.migrationParams.coinIndex,e.next=29,this.functionsUtil.getCurveTokenPrice();case 29:h=e.sent,d=this.functionsUtil.normalizeTokenAmount(c.times(h).minus(c.times(i.div(100))),this.state.tokenConfig.decimals),console.log("remove_liquidity_one_coin",l,p,d),this.props.contractMethodSendWrapper(o,"remove_liquidity_one_coin",[l,p,d,this.state.redeemUnderlying],null,t,n);case 33:this.setState(function(e){return{processing:Object(a.a)({},e.processing,{loading:!0})}});case 34:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var e=Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFastBalanceSelector",value:function(){return null!==this.state.fastBalanceSelector&&this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100)}},{key:"render",value:function(){var e=this,t=!this.state.buttonDisabled&&this.state.withdrawSlippage,n=this.functionsUtil.getGlobalConfig(["curve","poolContract","token"]);return m.a.createElement(E.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(E.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.state.curveTokenBalance?this.state.processing.loading?m.a.createElement(y.default,{cardProps:{p:3,mt:3}},m.a.createElement(E.h,{flexDirection:"column"},m.a.createElement(C.a,{web3:this.props.web3,hash:this.state.processing.txHash,endMessage:"Finalizing redeem request...",cancelTransaction:this.cancelTransaction.bind(this),waitText:this.props.waitText?this.props.waitText:"Redeem estimated in"}))):m.a.createElement(E.h,{width:1,flexDirection:"column"},m.a.createElement(y.default,{cardProps:{p:3,mb:2}},m.a.createElement(E.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(E.k,{size:"1.8em",color:"cellText",name:"FileUpload"}),m.a.createElement(E.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Withdraw from the Curve Pool in a specific token or in uneven amounts of tokens (with no slippage)."),m.a.createElement(E.h,{mt:2,alignItems:"center",flexDirection:"row"},m.a.createElement(E.e,{required:!1,label:"Redeem with no slippage",checked:this.state.redeemUnevenAmounts,onChange:function(t){return e.toggleUnevenAmounts(t.target.checked)}}),m.a.createElement(E.y,{placement:"top",message:"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool.")},m.a.createElement(E.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))),!this.state.redeemUnevenAmounts&&m.a.createElement(E.b,{mb:2,width:1},this.state.tokenConfig&&m.a.createElement(E.b,{width:1},m.a.createElement(E.u,{mb:1},"Select destination token:"),m.a.createElement(x.default,Object.assign({},this.props,{id:"token-from",showBalance:!1,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,onChange:this.selectDestinationToken.bind(this)})))),this.state.curveTokensAmounts&&!this.state.buttonDisabled&&m.a.createElement(y.default,{cardProps:{mt:1,mb:2,py:2,px:1}},m.a.createElement(E.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(E.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"You will receive:"),m.a.createElement(E.h,{mt:2,width:1,boxShadow:0,style:{flexWrap:"wrap"},alignItems:"center",justifyContent:"center"},Object.keys(this.state.curveTokensAmounts).map(function(t){var n=e.state.curveTokensAmounts[t];return m.a.createElement(E.h,{mb:1,mx:1,width:"auto",flexDirection:"row",key:"tokenBalance_".concat(t),justifyContent:"flex-start"},m.a.createElement(f.a,{token:t,tokenConfig:{token:t},fieldInfo:{name:"icon",props:{mr:1,width:["1.4em","1.6em"],height:["1.4em","1.6em"]}}}),m.a.createElement(v.a,{ml:1,fontSize:[0,1],fontWeight:500,maxPrecision:4,color:"cellText",number:n.toString()}))})))),this.state.showMaxSlippage&&t&&m.a.createElement(E.b,{mb:2,width:1},m.a.createElement(E.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(E.u,null,"Choose max slippage:"),m.a.createElement(E.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},m.a.createElement(E.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),m.a.createElement(E.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return m.a.createElement(w.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),m.a.createElement(E.h,{mb:3,width:1,flexDirection:"column"},m.a.createElement(E.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},t&&m.a.createElement(E.h,{width:1,maxWidth:"40%",alignItems:"center",flexDirection:"row"},m.a.createElement(E.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.withdrawSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.withdrawSlippage.toFixed(3))?"No Slippage":"".concat(this.state.withdrawSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.withdrawSlippage.abs().toFixed(3),"%")),m.a.createElement(E.y,{placement:"top",message:this.state.redeemUnevenAmounts?"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool."):this.state.withdrawSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},m.a.createElement(E.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),!this.state.redeemUnevenAmounts&&m.a.createElement(E.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage.bind(this)},"change")),m.a.createElement(E.h,{width:1,maxWidth:"60%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},m.a.createElement(E.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.state.curveTokenBalance.toFixed(this.props.isMobile?2:4)," ",n))),m.a.createElement(E.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),m.a.createElement(E.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return m.a.createElement(w.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})}))),m.a.createElement(E.h,{justifyContent:"center"},m.a.createElement(b.default,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.redeem.bind(this)},"Redeem"))):m.a.createElement(y.default,{cardProps:{p:3,mt:3,minHeight:"195px",style:{display:"flex",alignItems:"center",justifyContent:"center"}}},m.a.createElement(g.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking Curve Pool..."}))))}}]),t}(d.Component);t.a=S},4857:function(e,t,n){e.exports={twitterIcon:"TwitterShareButton_twitterIcon__2QCmn"}},4863:function(e,t,n){"use strict";n.r(t);var a=n(132),o=n(99),i=n(35),s=n(36),r=n(1),c=n.n(r),l=n(6),u=n(11),p=n(12),h=n(15),d=n(14),m=n(18),f=n(129),g=n(481),v=n(0),b=n.n(v),k=n(163),x=n(4746),C=n(4754),y=n(69),w=n(50),E=n(591),S=n(32),T=n(261),U=n(202),j=n(4),A=n(63),B=n(4857),D=n.n(B),O=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n.share=function(){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"Share",eventAction:"twitter",eventLabel:n.props.parent});var e=Math.min(window.innerWidth,600),t=(window.innerWidth-e)/2;window.open("https://twitter.com/intent/tweet?text=".concat(n.props.tweet),"_blank","toolbar=yes,scrollbars=no,resizable=no,top=".concat(150,",left=").concat(t,",width=").concat(e,",height=").concat(350))},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new w.a(this.props)}},{key:"componentWillMount",value:function(){this.loadUtils()}},{key:"componentDidMount",value:function(){this.loadUtils()}},{key:"componentDidUpdate",value:function(){this.loadUtils()}},{key:"render",value:function(){var e=this;return b.a.createElement(j.c,{borderRadius:1,mainColor:"#2aa6f2",contrastColor:"white",onClick:function(t){e.share()}},b.a.createElement(j.h,{flexDirection:"row",alignItems:"center",justifyContent:"center"},b.a.createElement(j.b,{className:D.a.twitterIcon}),b.a.createElement(j.u,{color:"white",fontWeight:3,ml:2},this.props.text?this.props.text:"Tweet")))}}]),t}(v.Component),I=n(4859),M=n.n(I),P=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n.closeModal=function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfigs().analytics.google.events.enabled){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"Share",eventAction:t,eventLabel:"ShareModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new w.a(this.props)}},{key:"componentWillMount",value:function(){this.loadUtils()}},{key:"componentDidMount",value:function(){this.loadUtils()}},{key:"componentDidUpdate",value:function(){this.loadUtils()}},{key:"render",value:function(){var e=this,t=window.escape(this.props.tweet),n={__html:this.props.text};return b.a.createElement(j.p,{isOpen:this.props.isOpen},b.a.createElement(A.a,{closeFunc:this.props.closeModal},this.props.confettiEnabled&&b.a.createElement(M.a,{style:{position:"fixed",zIndex:9999},run:!0,recycle:!0,width:window.innerWidth,height:window.innerHeight}),b.a.createElement(A.a.Header,{title:this.props.title,icon:this.props.icon}),b.a.createElement(A.a.Body,null,b.a.createElement(j.h,{my:3,width:1,flexDirection:"column",mx:"auto"},b.a.createElement(j.u,{color:"dark-gray",textAlign:"center",fontSize:3,mb:2,dangerouslySetInnerHTML:n})),b.a.createElement(j.h,{mb:3,flexDirection:"column",alignItems:"center",justifyContent:"center"},b.a.createElement(O,{tweet:t,text:"Share now",parent:"ShareModal"}),b.a.createElement(j.n,{mt:2,onClick:function(t){return e.closeModal("continue_without_sharing")},hoverColor:"blue"},"continue without sharing")))))}}]),t}(b.a.Component),z=n(301),F=n(355),R=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,p=new Array(r),m=0;m<r;m++)p[m]=arguments[m];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(p)))).state={txError:{},tokenAPY:"-",inputValue:{},processing:{},curveAPY:null,canRedeem:!1,maxSlippage:.2,canDeposit:!1,action:"deposit",directMint:!1,activeModal:null,showBuyFlow:!1,unlentBalance:null,tokenApproved:!1,skipMigration:!1,showRedeemFlow:!1,contractPaused:!1,buttonDisabled:!1,canRedeemCurve:!1,showMaxSlippage:!1,redeemGovTokens:!1,canDepositCurve:!1,fastBalanceSelector:{},actionProxyContract:{},migrationEnabled:!1,componentMounted:!1,curveTokenBalance:null,redeemCurveEnabled:!1,depositCurveBalance:null,depositCurveEnabled:!0,showAdvancedOptions:!1,depositCurveSlippage:null,metaTransactionsEnabled:!0},n.functionsUtil=null,n.setShowRedeemFlow=function(e){n.setState({showRedeemFlow:e})},n.setShowBuyFlow=function(e){n.setState({showBuyFlow:e})},n.toggleShowAdvancedOptions=function(e){n.setState(function(e){return{showAdvancedOptions:!e.showAdvancedOptions}})},n.toggleSkipMigration=function(e){n.setState({skipMigration:e})},n.toggleRedeemCurve=function(e){n.setState({redeemCurveEnabled:e})},n.toggleDepositCurve=function(e){n.setState({depositCurveEnabled:e})},n.toggleSkipMint=function(e){n.setState({directMint:e})},n.toggleRedeemGovTokens=function(e){n.setState({redeemGovTokens:e})},n.toggleMetaTransactionsEnabled=function(e){n.setState({metaTransactionsEnabled:e})},n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.approveContract=function(){var e=Object(l.a)(c.a.mark(function e(t,a){var o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.state.depositCurveEnabled?(o=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),n.functionsUtil.enableERC20(n.props.selectedToken,o.address,t,a)):(i=n.state.actionProxyContract[n.state.action])&&n.state.metaTransactionsEnabled&&n.props.biconomy?n.functionsUtil.enableERC20(n.props.selectedToken,i.address,t,a):n.functionsUtil.enableERC20(n.props.selectedToken,n.props.tokenConfig.idle.address,t,a);case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.checkTokenApproved=Object(l.a)(c.a.mark(function e(){var t,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,!n.state.depositCurveEnabled){e.next=8;break}return a=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),e.next=5,n.functionsUtil.checkTokenApproved(n.props.selectedToken,a.address,n.props.account);case 5:t=e.sent,e.next=18;break;case 8:if(!((o=n.state.actionProxyContract[n.state.action])&&n.state.metaTransactionsEnabled&&n.props.biconomy)){e.next=15;break}return e.next=12,n.functionsUtil.checkTokenApproved(n.props.selectedToken,o.address,n.props.account);case 12:t=e.sent,e.next=18;break;case 15:return e.next=17,n.functionsUtil.checkTokenApproved(n.props.selectedToken,n.props.tokenConfig.idle.address,n.props.account);case 17:t=e.sent;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this)})),n.approveToken=Object(l.a)(c.a.mark(function e(){var t,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkTokenApproved();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(s.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 5:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.props.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(s.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},o=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,{approve:Object(s.a)({},e.processing.approve,{txHash:t})})}})},n.approveContract(a,o),n.setState(function(e){return{processing:Object(s.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 9:case"end":return e.stop()}},e,this)})),n.loadTokenInfo=Object(l.a)(c.a.mark(function e(){var t,a,o,r,l,u,p,h,d,m,f,g,v,b,k,x,C,y,w;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.state.componentMounted&&n.setState({componentMounted:!1}),t=n.functionsUtil.getGlobalConfig(["curve"]),a=n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token]),o=t.enabled&&a&&a.enabled,e.next=6,Promise.all([n.checkTokenApproved(),n.functionsUtil.checkContractPaused(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract(),n.functionsUtil.getUnlentBalance(n.props.tokenConfig),n.functionsUtil.checkMigration(n.props.tokenConfig,n.props.account),o?n.functionsUtil.getCurveTokenBalance(n.props.account):null]);case 6:r=e.sent,l=Object(i.a)(r,7),u=l[0],p=l[1],h=l[2],d=l[3],m=l[4],f=l[5].migrationEnabled,g=l[6],v=n.props.tokenBalance&&n.functionsUtil.BNify(n.props.tokenBalance).gt(0),b=n.props.idleTokenBalance&&n.functionsUtil.BNify(n.props.idleTokenBalance).gt(0),x=k=o&&v,C=o&&g&&g.gt(0),y=C,(w=Object(s.a)({},n.state)).depositCurveEnabled&&!o&&(w.depositCurveEnabled=!1),w.canRedeem=b,w.canDeposit=v,w.unlentBalance=m,w.tokenApproved=u,w.contractPaused=p,w.canRedeemCurve=C,w.canDepositCurve=k,w.migrationEnabled=f,w.curveTokenBalance=g,w.curveSwapContract=h,w.redeemCurveEnabled=y,w.depositCurveEnabled=x,w.curveDepositContract=d,w.txError={redeem:!1,deposit:!1},w.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1},boost:{txHash:null,loading:!1}},w.inputValue={boost:null,redeem:null,deposit:null},w.fastBalanceSelector={boost:null,redeem:null,deposit:null},w.componentMounted=!0,n.setState(w,function(){n.checkAction(),n.loadAPY()});case 42:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.executeAction=Object(l.a)(c.a.mark(function e(){var t,r,l,u,p,h,d,m,f,g,v,b,k,x,C,y,w,E,S,T,U,j,A,B,D,O,I,M,P,z,F,R,G,V;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,r=n.state.redeemGovTokens,l=n.state.inputValue[n.state.action],u=n.getFastBalanceSelector(),p=!0,e.t0=n.state.action,e.next="deposit"===e.t0?8:"redeem"===e.t0?68:98;break;case 8:if(!n.state.buttonDisabled&&l&&!n.functionsUtil.BNify(l).lte(0)){e.next=10;break}return e.abrupt("return",!1);case 10:if(n.state.tokenApproved){e.next=12;break}return e.abrupt("return",n.approveToken());case 12:if(localStorage&&n.functionsUtil.setLocalStorage("redirectToFundsAfterLogged",0),n.setState({lendingProcessing:n.props.account,lendAmount:"",genericError:""}),h=function(e,t){!e&&t&&(e={status:"error"});var a="error"===e.status,i="success"===e.status,r={eventCategory:"Deposit",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(l)};t&&(r.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==r.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(r),n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,{txHash:null,loading:!1}))}}),i?n.setState(function(e){return{activeModal:"share",inputValue:Object(s.a)({},e.inputValue,Object(o.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):n.state.metaTransactionsEnabled&&a&&n.setState({txError:Object(o.a)({},n.state.action,!0)})},d=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{txHash:t})))}})},m=n.functionsUtil.getGlobalConfig(["curve"]),!(m.enabled&&n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token,"enabled"]))||!n.state.depositCurveEnabled){e.next=34;break}return f=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),g=n.functionsUtil.normalizeTokenAmount(l,f.decimals),e.next=23,n.functionsUtil.getCurveAmounts(n.props.tokenConfig.idle.token,g);case 23:return v=e.sent,e.next=26,n.functionsUtil.getCurveTokenAmount(v);case 26:return b=e.sent,n.state.maxSlippage&&(b=(b=n.functionsUtil.BNify(b)).minus(b.times(n.functionsUtil.BNify(n.state.maxSlippage).div(100))),b=n.functionsUtil.integerValue(b)),k=[v,b],e.next=31,n.functionsUtil.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",k,h,d);case 31:t=e.sent,e.next=67;break;case 34:if(x=n.functionsUtil.normalizeTokenAmount(l,n.props.tokenConfig.decimals),C=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","metaTransactionsEnabled"]),y=[],w=n.state.actionProxyContract[n.state.action],!(C&&w&&n.props.biconomy&&n.state.metaTransactionsEnabled)){e.next=53;break}if(E=n.state.actionProxyContract[n.state.action].contract,y=[x,n.props.tokenConfig.idle.address],!n.state.metaTransactionsEnabled){e.next=48;break}return T=(S=E.methods)[w.function].apply(S,Object(a.a)(y)).encodeABI(),e.next=45,n.functionsUtil.sendBiconomyTxWithPersonalSign(w.name,T,h,d);case 45:t=e.sent,e.next=51;break;case 48:return e.next=50,n.functionsUtil.contractMethodSendWrapper(w.name,w.function,y,h,d);case 50:t=e.sent;case 51:e.next=67;break;case 53:if(U=!n.state.directMint&&n.functionsUtil.getGlobalConfig(["contract","methods","deposit","skipMint"]),!(U="undefined"!==typeof n.props.tokenConfig.skipMintForDeposit?n.props.tokenConfig.skipMintForDeposit:U)){e.next=63;break}return e.next=58,Promise.all([n.functionsUtil.genericContractCall("idleDAIYield","maxUnlentPerc"),n.functionsUtil.loadAssetField("pool",n.props.selectedToken,n.props.tokenConfig,n.props.account)]);case 58:j=e.sent,A=Object(i.a)(j,2),B=A[0],D=A[1],B&&D&&(O=l.div(D).times(100),B=n.functionsUtil.BNify(B).div(1e3),O.gte(B.times(2))&&(U=!1));case 63:return y=[x,U,"0x0000000000000000000000000000000000000000"],e.next=66,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"mintIdleToken",y,h,d);case 66:t=e.sent;case 67:return e.abrupt("break",100);case 68:if(!r){e.next=76;break}return I=function(e,t){var a="success"===e.status,i={eventCategory:"Redeem_gov",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:0};t&&(i.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==i.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(i),n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(s.a)({},e.inputValue,Object(o.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},M=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=73,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"redeemIdleToken",[0],I,M);case 73:t=e.sent,e.next=97;break;case 76:if(!n.state.buttonDisabled&&l&&!n.functionsUtil.BNify(l).lte(0)){e.next=78;break}return e.abrupt("return",!1);case 78:if(P={value:n.functionsUtil.BNify(l)},z=null,!u){e.next=84;break}z=n.functionsUtil.BNify(n.props.idleTokenBalance).times(u),e.next=88;break;case 84:return e.next=86,n.functionsUtil.genericContractCall(n.props.tokenConfig.idle.token,"tokenPrice");case 86:F=e.sent,z=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(l,n.props.tokenConfig.decimals)).div(F);case 88:if(z=n.functionsUtil.normalizeTokenAmount(z,18)){e.next=91;break}return e.abrupt("return",!1);case 91:return R=function(e,t){var a="success"===e.status,i={eventCategory:"Redeem_partial",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(l)};t&&(i.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==i.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(i),n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(s.a)({},e.inputValue,Object(o.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},G=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{txHash:t})))}})},V=[z],e.next=96,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"redeemIdleToken",V,R,G,P);case 96:t=e.sent;case 97:return e.abrupt("break",100);case 98:return p=!1,e.abrupt("break",100);case 100:!1!==t&&n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(o.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{loading:p})))}});case 101:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.showMaxSlippage=function(){n.setState({showMaxSlippage:!0})},n.checkAction=function(){var e=n.state.action;switch(e){case"redeem":n.state.canRedeem||(e="deposit")}e!==n.state.action?n.setState({action:e},function(){n.checkButtonDisabled()}):n.checkButtonDisabled()},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&e.gt(n.props.tokenBalance);break;case"redeem":t=!n.state.canRedeemCurve&&!n.state.redeemGovTokens&&(t||e&&e.gt(n.props.redeemableBalance))}n.setState({buttonDisabled:t})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.props.tokenBalance?n.functionsUtil.BNify(n.props.tokenBalance).times(e):null;break;case"redeem":t=n.props.redeemableBalance?n.functionsUtil.BNify(n.props.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(s.a)({},e.inputValue,Object(o.a)({},n.state.action,t))}})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(s.a)({},t.fastBalanceSelector,Object(o.a)({},n.state.action,e))}})},n.changeInputValue=function(e){if(!n.state.action)return!1;var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t),n.setState(function(e){return{fastBalanceSelector:Object(s.a)({},e.fastBalanceSelector,Object(o.a)({},n.state.action,null)),inputValue:Object(s.a)({},e.inputValue,Object(o.a)({},n.state.action,t))}})},n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||n.state.canRedeemCurve||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new w.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadProxyContracts();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadProxyContracts",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=["deposit","redeem"],n={actionProxyContract:{}},e.next=4,this.functionsUtil.asyncForEach(t,function(){var e=Object(l.a)(c.a.mark(function e(t){var o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.functionsUtil.getGlobalConfig(["contract","methods",t,"proxyContract"]),i=o&&o.enabled,n.actionProxyContract[t]=i?o:null,!i){e.next=11;break}return e.next=6,a.props.initContract(o.name,o.address,o.abi);case 6:return s=e.sent,n.actionProxyContract[t].contract=s.contract,e.next=10,a.functionsUtil.checkTokenApproved(a.props.selectedToken,o.address,a.props.account);case 10:n.actionProxyContract[t].approved=e.sent;case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 4:this.setState(n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadAPY",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getTokenAprs(this.props.tokenConfig);case 2:if(!(t=e.sent)||null===t.avgApy){e.next=12;break}if(n=this.functionsUtil.BNify(t.avgApy).toFixed(2),a=null,!this.state.canDepositCurve){e.next=11;break}return e.next=9,this.functionsUtil.getCurveAPY();case 9:(a=e.sent)&&(a=a.plus(n));case 11:this.setState({tokenAPY:n,curveAPY:a});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(l.a)(c.a.mark(function e(t,n){var a,o,i,s,r,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),null!==this.props.tokenBalance){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=t.selectedToken!==this.props.selectedToken,o=t.tokenBalance!==this.props.tokenBalance&&null!==this.props.tokenBalance,!a&&!o){e.next=10;break}return e.next=8,this.loadProxyContracts();case 8:return this.loadTokenInfo(),e.abrupt("return",!1);case 10:if(i=this.state.action!==n.action,s=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(i||s)&&this.setInputValue(),(n.redeemGovTokens!==this.state.redeemGovTokens||i)&&this.checkButtonDisabled(),r=n.depositCurveEnabled!==this.state.depositCurveEnabled,!(n.metaTransactionsEnabled!==this.state.metaTransactionsEnabled)&&!r){e.next=22;break}return e.next=20,this.checkTokenApproved();case 20:l=e.sent,this.setState({tokenApproved:l});case 22:n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateCurveSlippage();case 24:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"calculateCurveSlippage",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),a=this.functionsUtil.normalizeTokenAmount(t,n.decimals),o={},e.t0=this.state.action,e.next="deposit"===e.t0?9:"redeem"===e.t0?14:15;break;case 9:return o.depositCurveBalance=t,e.next=12,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,a,!0);case 12:return o.depositCurveSlippage=e.sent,e.abrupt("break",16);case 14:case 15:return e.abrupt("break",16);case 16:this.setState(o);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken||!this.props.tokenConfig)return null;var t=this.props.tokenConfig.govTokensDisabled,n=this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"govTokensEnabled"]),a="undefined"===typeof this.props.tokenConfig.skipMintForDeposit||this.props.tokenConfig.skipMintForDeposit,o=this.functionsUtil.getGlobalConfig(["contract","methods","deposit","skipMintCheckboxEnabled"])&&a,i=this.functionsUtil.getGlobalConfig(["contract","methods","redeemGovTokens","enabled"])&&!t&&n,s=i&&this.state.redeemGovTokens&&"redeem"===this.state.action,r=this.props.biconomy&&this.state.actionProxyContract[this.state.action],c=r&&this.state.metaTransactionsEnabled,l="deposit"===this.state.action?this.props.tokenBalance:this.props.redeemableBalance,u=this.state.migrationEnabled&&void 0!==this.props.tokenConfig.migration.message?this.props.tokenConfig.migration.message:null,p=this.functionsUtil.getGlobalConfig(["curve"]),h=p.enabled&&this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.tokenConfig.idle.token,"enabled"]),d=h&&this.state.depositCurveEnabled&&"deposit"===this.state.action,m="deposit"===this.state.action&&!this.state.contractPaused&&(h||this.state.tokenApproved),v="deposit"===this.state.action&&this.state.canDeposit||"redeem"===this.state.action&&this.state.canRedeem||s,w=m&&h&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canDepositCurve&&"deposit"===this.state.action,A=h&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canRedeemCurve&&"redeem"===this.state.action,B=!s&&v,D=this.state.componentMounted&&(!w||this.state.showBuyFlow)&&!this.state.depositCurveEnabled&&this.state.tokenApproved&&!this.state.contractPaused&&(!this.state.migrationEnabled||this.state.skipMigration)&&"deposit"===this.state.action&&!this.state.canDeposit,O=this.state.canRedeem&&(!this.state.redeemCurveEnabled||this.state.showRedeemFlow),I=d&&this.state.depositCurveSlippage&&this.state.depositCurveBalance&&!this.state.buttonDisabled,M=m&&this.state.canDeposit&&o&&"deposit"===this.state.action,R=w||M,G=this.functionsUtil.getGlobalConfig(["tools","batchDeposit"]),V=G.enabled&&"undefined"!==typeof G.props.availableTokens[this.props.tokenConfig.idle.token],N=G.depositEnabled,W=V&&N&&!this.props.isMigrationTool&&"deposit"===this.state.action;return b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.b,{width:1},b.a.createElement(j.u,{mb:1},"Select your asset:"),b.a.createElement(T.default,this.props)),b.a.createElement(g.a,Object.assign({},this.props,{migrateTextBefore:u,migrateText:null!==u?"":null,toggleSkipMigration:this.toggleSkipMigration.bind(this)}),this.props.account?this.state.componentMounted?this.state.action?b.a.createElement(j.b,{width:1},b.a.createElement(j.h,{mt:2,flexDirection:"column"},b.a.createElement(j.u,{mb:2},"Choose the action:"),b.a.createElement(j.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},b.a.createElement(S.default,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},b.a.createElement(j.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},b.a.createElement(z.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:3}}}),b.a.createElement(j.u,{fontSize:3,fontWeight:3},"Deposit"))),b.a.createElement(S.default,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isActive:"redeem"===this.state.action,isDisabled:!this.state.canRedeem&&!this.state.canRedeemCurve},b.a.createElement(j.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},b.a.createElement(z.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:3}}}),b.a.createElement(j.u,{fontSize:3,fontWeight:3},"Redeem"))))),R?b.a.createElement(S.default,{cardProps:{pt:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",pb:this.state.showAdvancedOptions?3:2}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},b.a.createElement(j.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:this.toggleShowAdvancedOptions},this.state.showAdvancedOptions?"Hide":"Show"," advanced options"),b.a.createElement(j.k,{size:"1.8em",color:"cellText",name:this.state.showAdvancedOptions?"ArrowDropUp":"ArrowDropDown"})),this.state.showAdvancedOptions&&b.a.createElement(j.h,{mt:1,flexDirection:"column"},w&&b.a.createElement(j.h,{alignItems:"center",justifyContent:"row"},b.a.createElement(j.e,{required:!1,disabled:this.state.directMint,label:"Deposit in the Curve Pool",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}),b.a.createElement(j.n,{mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"(read more)")),M&&b.a.createElement(j.h,{alignItems:"center",justifyContent:"row"},b.a.createElement(j.e,{required:!1,label:"Rebalance the pool",checked:this.state.directMint,disabled:this.state.depositCurveEnabled,onChange:function(t){return e.toggleSkipMint(t.target.checked)}}),b.a.createElement(j.y,{placement:"bottom",message:this.functionsUtil.getGlobalConfig(["messages","directMint"])},b.a.createElement(j.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))):b.a.createElement(j.h,{width:1,flexDirection:"column"},w&&b.a.createElement(j.h,{width:1,flexDirection:"column",justifyContent:"center"},b.a.createElement(S.default,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.l,{height:"1.8em",src:p.params.image}),b.a.createElement(j.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Deposit your tokens in the Curve Pool and boost your APY up to ",this.state.curveAPY?this.state.curveAPY.toFixed(2):"-","%.",b.a.createElement(j.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),b.a.createElement(j.e,{mt:2,required:!1,label:"Deposit in Curve",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}))),!this.state.showBuyFlow&&!this.state.depositCurveEnabled&&!this.state.canDeposit&&b.a.createElement(j.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowBuyFlow(!0)}},"I just want to deposit more ",this.props.selectedToken)),M&&b.a.createElement(S.default,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),b.a.createElement(j.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"By checking this flag you can rebalance the pool and help all users gain an additional APR")),b.a.createElement(j.e,{mt:2,required:!1,label:"Rebalance the pool",checked:this.state.directMint,onChange:function(t){return e.toggleSkipMint(t.target.checked)}}))),r&&!D&&!this.state.contractPaused&&b.a.createElement(S.default,{cardProps:{py:3,px:2,my:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},this.state.metaTransactionsEnabled&&this.state.txError[this.state.action]&&this.state.actionProxyContract[this.state.action].approved?b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.k,{size:"1.8em",name:"Warning",color:"cellText"}),b.a.createElement(j.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Seems like you are having some trouble with Meta-Transactions... Disable them by unchecking the box below and try again!")):"WalletConnect"===this.functionsUtil.getWalletProvider()&&this.state.metaTransactionsEnabled?b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.k,{size:"1.8em",name:"Warning",color:"cellText"}),b.a.createElement(j.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Please disable Meta-Transactions if you are using Argent Wallet to avoid failed transactions!")):b.a.createElement(j.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Meta-Transactions are ",this.state.metaTransactionsEnabled?"available":"disabled"," for ",this.state.action,"s!",b.a.createElement("br",null),this.state.metaTransactionsEnabled&&!this.state.actionProxyContract[this.state.action].approved&&"Please either enable the Smart-Contract to enjoy gas-less ".concat(this.state.action," or just disable meta-tx.")),b.a.createElement(j.e,{mt:2,required:!1,checked:this.state.metaTransactionsEnabled,onChange:function(t){return e.toggleMetaTransactionsEnabled(t.target.checked)},label:"".concat(this.functionsUtil.capitalize(this.state.action)," with Meta-Transaction")})),W&&b.a.createElement(j.h,{p:2,mt:3,width:1,borderRadius:2,alignItems:"center",flexDirection:"row",justifyContent:"center",backgroundColor:"white",border:"1px solid ".concat(this.props.theme.colors.primary)},b.a.createElement(j.n,{textAlign:"center",hoverColor:"primary",href:"/#/dashboard/tools/".concat(G.route,"/").concat(this.props.tokenConfig.idle.token)},"Gas fees too high? Save gas with our Batch Deposit!"),b.a.createElement(j.k,{ml:1,size:"1em",color:"primary",name:"LocalGasStation"})),A&&this.state.canRedeem&&b.a.createElement(j.h,{width:1,flexDirection:"column",justifyContent:"center"},b.a.createElement(S.default,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.l,{height:"1.8em",src:p.params.image}),b.a.createElement(j.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Redeem your tokens from the Curve Pool.",b.a.createElement(j.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),this.state.canRedeem&&b.a.createElement(j.e,{mt:2,required:!1,label:"Redeem from Curve",checked:this.state.redeemCurveEnabled,onChange:function(t){return e.toggleRedeemCurve(t.target.checked)}}))),this.canRedeem&&b.a.createElement(j.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowRedeemFlow(!0)}},"I just want to redeem my ",this.props.selectedToken)),"redeem"===this.state.action&&this.state.unlentBalance&&O&&b.a.createElement(S.default,{cardProps:{py:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.k,{size:"1.8em",color:"cellText",name:"LocalGasStation"}),b.a.createElement(j.u,{px:2,fontSize:1,color:"cellText",textAlign:"center"},"Available balance for Cheap Redeem"),b.a.createElement(j.h,{alignItems:"center",flexDirection:"row"},b.a.createElement(j.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"center",hoverColor:"copyColor"},this.state.unlentBalance.toFixed(4)," ",this.props.selectedToken),b.a.createElement(j.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","cheapRedeem"])},b.a.createElement(j.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))))),"redeem"===this.state.action&&i&&O&&b.a.createElement(S.default,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(j.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),b.a.createElement(j.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"By redeeming your ",this.props.selectedToken," you will automatically get also the proportional amount of governance tokens accrued",this.props.govTokensBalance&&this.props.govTokensBalance.gt(0)?" (~ $".concat(this.props.govTokensBalance.toFixed(2),")"):null,".")),b.a.createElement(j.e,{mt:2,required:!1,checked:this.state.redeemGovTokens,label:"Redeem governance tokens only",onChange:function(t){return e.toggleRedeemGovTokens(t.target.checked)}})),this.state.contractPaused&&"deposit"===this.state.action?b.a.createElement(S.default,{cardProps:{p:3,mt:3}},b.a.createElement(j.h,{alignItems:"center",flexDirection:"column"},b.a.createElement(j.k,{size:"1.8em",name:"Warning",color:"cellText"}),b.a.createElement(j.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Deposits for ",this.props.selectedToken," are temporarily unavailable due to Smart-Contract maintenance. Redeems are always available."))):this.state.tokenApproved||"deposit"!==this.state.action?!D&&v&&(this.state.processing[this.state.action].loading?b.a.createElement(j.h,{mt:4,flexDirection:"column"},b.a.createElement(U.a,{web3:this.props.web3,cancelTransaction:this.cancelTransaction.bind(this),hash:this.state.processing[this.state.action].txHash,endMessage:"Finalizing ".concat(this.state.action," request..."),waitText:"".concat(this.functionsUtil.capitalize(this.state.action)," estimated in")})):b.a.createElement(j.h,{mt:2,flexDirection:"column"},B&&b.a.createElement(j.h,{mb:3,width:1,flexDirection:"column"},(l||this.props.tokenFeesPercentage)&&b.a.createElement(j.b,{mb:1,width:1},this.state.showMaxSlippage&&I&&b.a.createElement(j.b,{mb:2,width:1},b.a.createElement(j.h,{alignItems:"center",flexDirection:"row"},b.a.createElement(j.u,null,"Choose max slippage:"),b.a.createElement(j.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},b.a.createElement(j.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),b.a.createElement(j.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return b.a.createElement(F.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),b.a.createElement(j.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},I?b.a.createElement(j.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},b.a.createElement(j.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:this.state.depositCurveSlippage.gt(0)?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositCurveSlippage.times(100).toFixed(2))?"No Slippage":"".concat(this.state.depositCurveSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositCurveSlippage.times(100).abs().toFixed(2),"%")),b.a.createElement(j.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","curveBonusSlippage"])},b.a.createElement(j.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),b.a.createElement(j.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage},"change")):this.props.tokenFeesPercentage&&b.a.createElement(j.h,{alignItems:"center",flexDirection:"row"},b.a.createElement(j.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor"},"Performance fee: ",this.props.tokenFeesPercentage.times(100).toFixed(2),"%"),b.a.createElement(j.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","performanceFee"])},b.a.createElement(j.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),l&&b.a.createElement(j.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)}},l.toFixed(6)," ",this.props.selectedToken))),b.a.createElement(j.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(f.a.colors.divider),value:null!==this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]).toFixed():""}),b.a.createElement(j.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return b.a.createElement(F.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector[e.state.action]===parseInt(t)})}))),v&&b.a.createElement(j.h,{justifyContent:"center",mt:s?2:0},b.a.createElement(y.default,{buttonProps:{width:"auto",minWidth:[1,.5],style:{textTransform:"capitalize"},disabled:this.state.buttonDisabled},handleClick:this.state.buttonDisabled?null:this.executeAction.bind(this)},this.state.action,s?" Gov Tokens":"")))):b.a.createElement(S.default,{cardProps:{p:3,mt:3}},this.state.processing.approve&&this.state.processing.approve.loading?b.a.createElement(j.h,{flexDirection:"column"},b.a.createElement(U.a,{web3:this.props.web3,waitText:"Approve estimated in",endMessage:"Finalizing approve request...",hash:this.state.processing.approve.txHash,cancelTransaction:this.cancelTransaction.bind(this)})):b.a.createElement(j.h,{alignItems:"center",flexDirection:"column"},b.a.createElement(j.k,{size:"1.8em",name:"LockOpen",color:"cellText"}),b.a.createElement(j.u,{mt:3,fontSize:2,color:"cellText",textAlign:"center"},this.state.depositCurveEnabled?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."):c?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle using Meta-Transaction you need to approve our Smart-Contract first."):"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle you need to approve our Smart-Contract first.")),b.a.createElement(y.default,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approveToken.bind(this)},"Approve")))):null:b.a.createElement(j.h,{mt:4,flexDirection:"column"},b.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading asset info..."})):b.a.createElement(x.a,this.props))),A&&this.state.redeemCurveEnabled&&b.a.createElement(j.b,{mt:3,width:1},b.a.createElement(C.a,this.props)),D&&b.a.createElement(j.h,{mt:3,width:[1,.5],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},b.a.createElement(E.default,Object.assign({},this.props,{showInline:!0,availableMethods:[],buyToken:this.props.selectedToken}))),b.a.createElement(P,{confettiEnabled:!0,icon:"images/medal.svg",title:"Congratulations!",account:this.props.account,closeModal:this.resetModal,tokenName:this.props.selectedToken,isOpen:"share"===this.state.activeModal,text:"You have successfully deposited in Idle!<br />Enjoy <strong>".concat(this.state.tokenAPY,"% APY</strong> on your <strong>").concat(this.props.selectedToken,"</strong>!"),tweet:"I'm earning ".concat(this.state.tokenAPY,"% APY on my ").concat(this.props.selectedToken," with @idlefinance! Go to ").concat(this.functionsUtil.getGlobalConfig(["baseURL"])," and start earning now from your idle tokens!")}))}}]),t}(v.Component);t.default=R}}]);
//# sourceMappingURL=35.1c4c396e.chunk.js.map