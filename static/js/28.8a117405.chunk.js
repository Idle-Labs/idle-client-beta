(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{4950:function(e,t,n){"use strict";n.r(t);var a=n(36),s=n(1),r=n.n(s),c=n(6),i=n(11),o=n(12),l=n(15),u=n(14),p=n(18),h=n(4),d=n(0),b=n.n(d),f=n(163),g=n(69),v=n(50),w=n(202),m=function(e){function t(){var e,n;Object(i.a)(this,t);for(var s=arguments.length,o=new Array(s),p=0;p<s;p++)o[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!0,processing:{rebalance:{txHash:null,loading:!1}},shouldRebalance:null},n.functionsUtil=null,n.checkRebalance=Object(c.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.next=3,n.functionsUtil.checkRebalance(n.props.tokenConfig);case 3:t=e.sent,n.setState({loading:!1,shouldRebalance:t});case 5:case"end":return e.stop()}},e,this)})),n.rebalance=function(){var e=Object(c.a)(r.a.mark(function e(t){var s,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),s=function(e,t){var s={eventCategory:"Rebalance",eventAction:n.props.selectedToken,eventLabel:e.status};t&&(s.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==s.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(s),"success"===e.status?window.toastProvider.addMessage("Rebalance completed",{secondaryMessage:"Now the pool is balanced!",colorTheme:"light",actionHref:"",actionText:"",variant:"success"}):window.toastProvider.addMessage("Rebalance error",{secondaryMessage:"The rebalance has failed, try again...",colorTheme:"light",actionHref:"",actionText:"",variant:"failure"}),n.setState(function(e){return{processing:Object(a.a)({},e.processing,{rebalance:{txHash:null,loading:!1}})}}),n.checkRebalance()},c=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(a.a)({},e.processing,{rebalance:Object(a.a)({},e.processing.rebalance,{txHash:t})})}})},n.props.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"rebalance",[],null,s,c),n.setState({processing:{rebalance:{txHash:null,loading:!0}}});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new v.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.checkRebalance();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t,n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.account!==this.props.account,(t.selectedToken!==this.props.selectedToken||a)&&this.checkRebalance();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return b.a.createElement(h.h,{px:3,width:1,minHeight:"100px",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.loading?b.a.createElement(f.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking rebalance..."}):this.state.processing.rebalance.loading?b.a.createElement(w.a,{web3:this.props.web3,waitText:"Rebalance estimated in",endMessage:"Finalizing rebalance request...",hash:this.state.processing.rebalance.txHash}):b.a.createElement(h.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},b.a.createElement(h.u,{mt:0,mb:3,textAlign:"center"},this.state.shouldRebalance?"Rebalance the entire pool. All users will bless you.":"The pool is already balanced."),b.a.createElement(g.default,{buttonProps:{width:"auto",disabled:!this.state.shouldRebalance},handleClick:function(t){return e.rebalance(t)}},"Rebalance")))}}]),t}(d.Component);t.default=m}}]);
//# sourceMappingURL=28.8a117405.chunk.js.map