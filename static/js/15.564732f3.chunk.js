(window.webpackJsonp=window.webpackJsonp||[]).push([[15,16],{1905:function(t,e,n){"use strict";n.r(e);var i=n(35),s=n(1),a=n.n(s),r=n(6),o=n(11),c=n(12),l=n(15),p=n(14),u=n(18),h=n(480),f=n.n(h),m=n(4),d=n(0),g=n.n(d),y=n(50),b=function(t){function e(){var t,n;Object(o.a)(this,e);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(n=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(s)))).state={earningsEnd:null,earningsStart:null},n.functionsUtil=null,n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new y.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(r.a)(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadTotalEarnings();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(r.a)(a.a.mark(function t(e,n){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),i=e.contractsInitialized!==this.props.contractsInitialized,(!e.availableStrategies&&JSON.stringify(e.availableStrategies)!==JSON.stringify(this.props.availableStrategies)||i)&&this.loadTotalEarnings();case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadTotalEarnings",value:function(){var t=Object(r.a)(a.a.mark(function t(){var e,n,s,o,c,l,p,u,h,f=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.props.availableStrategies&&this.props.contractsInitialized){t.next=2;break}return t.abrupt("return",!0);case 2:if(e="risk"===this.props.selectedStrategy,n=this.props.availableTokens||{},t.t0=this.props.portfolio,t.t0){t.next=9;break}return t.next=8,this.functionsUtil.getAccountPortfolio(n,this.props.account);case 8:t.t0=t.sent;case 9:return s=t.t0,o=Object.keys(s.tokensBalance).filter(function(t){return f.functionsUtil.BNify(s.tokensBalance[t].idleTokenBalance).gt(0)}),c=this.functionsUtil.BNify(0),l=this.functionsUtil.BNify(0),p=this.functionsUtil.BNify(0),t.next=16,this.functionsUtil.asyncForEach(o,function(){var t=Object(r.a)(a.a.mark(function t(r){var o,u,h,m,d,g,y,b,v;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n[r],t.next=3,Promise.all([f.functionsUtil.getTokenAprs(o),f.functionsUtil.getAmountLent([r],f.props.account),f.functionsUtil.loadAssetField("earnings",r,o,f.props.account,!1)]);case 3:return u=t.sent,h=Object(i.a)(u,3),m=h[0],d=h[1],g=h[2],y=f.functionsUtil.BNify(m.avgApy),b=s.tokensBalance[r].tokenBalance.div(s.totalBalance),t.next=12,f.functionsUtil.convertTokenBalance(d[r],r,o,e);case 12:v=t.sent,g&&(l=l.plus(g)),y&&(c=c.plus(y.times(b))),v&&(p=p.plus(v));case 16:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}());case 16:u=l,h=p.times(c.div(100)),this.setState({earningsEnd:h,earningsStart:u});case 19:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e={lineHeight:1,color:this.props.theme.colors.copyColor,fontFamily:this.props.theme.fonts.counter,fontWeight:this.props.isMobile?600:700,fontSize:this.props.isMobile?"21px":"1.7em"};this.props.counterStyle&&Object.keys(this.props.counterStyle).length&&Object.keys(this.props.counterStyle).forEach(function(n){e[n]=t.props.counterStyle[n]});var n=this.props.decimals||8,i=this.props.maxPrecision||10,s=this.props.minPrecision||8;return this.state.earningsStart&&this.state.earningsEnd?g.a.createElement(m.b,{width:1},g.a.createElement(f.a,{delay:0,decimal:".",separator:"",useEasing:!1,decimals:n,duration:31536e3,end:parseFloat(this.state.earningsEnd),start:parseFloat(this.state.earningsStart),formattingFn:function(e){return"$ "+t.functionsUtil.abbreviateNumber(e,n,i,s)}},function(t){var n=t.countUpRef;t.start;return g.a.createElement("span",{ref:n,style:e})})):g.a.createElement(m.o,{size:"20px"})}}]),e}(d.Component);e.default=b},4949:function(t,e,n){"use strict";n.r(e);var i=n(35),s=n(1),a=n.n(s),r=n(6),o=n(11),c=n(12),l=n(15),p=n(14),u=n(18),h=n(129),f=n(0),m=n.n(f),d=n(163),g=n(144),y=n(4),b=n(50),v=n(309),k=n(1905),w=function(t){function e(){var t,n;Object(o.a)(this,e);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(n=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(s)))).state={tokensEarnings:null,estimationStepsPerc:null,estimationStepsOptions:null,estimationStepsDefaultOption:null,estimationSteps:{0:{Month:{perc:1/12,width:1/3},"2 months":{perc:1/6,width:1/3},"3 months":{perc:.25,width:1/3,optionName:"3M"}},25:{"3 months":{perc:.25,width:.25},"8 months":{perc:8/12,width:5/12},Year:{perc:1,width:4/12,optionName:"1Y"}},90:{Year:{perc:1,width:1/3},"2 Years":{perc:2,width:1/3},"5 Years":{perc:5,width:.6,optionName:"5Y"}}}},n.functionsUtil=null,n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new b.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(r.a)(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadEarnings();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(r.a)(a.a.mark(function t(e,n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"setEstimationStepsPerc",value:function(t){this.setState({estimationStepsPerc:t})}},{key:"loadEarnings",value:function(){var t=Object(r.a)(a.a.mark(function t(){var e,n,s,o,c,l,p,u,h=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},n=0,s="risk"===this.props.selectedStrategy,t.next=5,this.functionsUtil.getAmountLent(this.props.enabledTokens,this.props.account);case 5:return o=t.sent,c={earnings:this.functionsUtil.BNify(0),amountLent:this.functionsUtil.BNify(0),earningsYear:this.functionsUtil.BNify(0)},t.next=9,this.functionsUtil.asyncForEach(Object.keys(o),function(){var t=Object(r.a)(a.a.mark(function t(r){var l,p,u,f,m,d,g,y,b,v,k,w,x,E;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l=h.props.availableTokens[r],t.next=3,Promise.all([h.functionsUtil.convertTokenBalance(o[r],r,l,s),h.functionsUtil.getAvgBuyPrice([r],h.props.account),h.functionsUtil.getIdleTokenPrice(l)]);case 3:return p=t.sent,u=Object(i.a)(p,3),f=u[0],m=u[1],d=u[2],g=d.div(m[r]).minus(1),y=f.times(g),b=0,v=0,t.next=14,h.functionsUtil.getTokenAprs(l);case 14:(k=t.sent)&&null!==k.avgApr&&(v=k.avgApy,b=f.times(v.div(100))),w=Math.floor(y.div(b).times(100)),x=Object.keys(h.state.estimationSteps).filter(function(t){return t<w}),E=parseInt(x.pop()),n=Math.max(n,E),h.functionsUtil.BNify(f).isNaN()||h.functionsUtil.BNify(d).isNaN()||h.functionsUtil.BNify(y).isNaN()||h.functionsUtil.BNify(b).isNaN()||(e[r]={earnings:y,amountLent:f,earningsYear:b,idleTokenPrice:d},c.earnings=c.earnings.plus(y),c.amountLent=c.amountLent.plus(f),c.earningsYear=c.earningsYear.plus(b));case 21:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}());case 9:l={},Object.keys(o).forEach(function(t){e[t]&&(l[t]=e[t])}),e=l,Object.keys(e).length>1&&(e.USD=c),p=null,u=Object.keys(this.state.estimationSteps).map(function(t){var e=Object.values(h.state.estimationSteps[t]).pop(),i=e.optionName?e.optionName:Object.keys(h.state.estimationSteps[t]).pop(),s=parseInt(t),a={value:s,label:i};return s===n&&(p=a),a}),this.setState({tokensEarnings:e,estimationStepsPerc:n,estimationStepsOptions:u,estimationStepsDefaultOption:p});case 16:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;if(!this.state.tokensEarnings)return m.a.createElement(d.a,{flexProps:{flexDirection:"row",minHeight:this.props.height},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading estimations..."});var e=this.state.estimationSteps[this.state.estimationStepsPerc]?this.state.estimationSteps[this.state.estimationStepsPerc]:this.state.estimationSteps[0];return m.a.createElement(y.d,{pr:0,my:1,width:1,px:[3,4],py:[2,3],boxShadow:1,borderRadius:2},m.a.createElement(y.h,{mt:2,mb:3,zIndex:9999,justifyContent:"flex-end"},m.a.createElement(y.h,{zIndex:9999,width:[1,.2],flexDirection:"column"},m.a.createElement(v.default,{innerProps:{p:0,px:1},name:"estimation-step",options:this.state.estimationStepsOptions,onChange:function(e){return t.setEstimationStepsPerc(e)},defaultValue:this.state.estimationStepsDefaultOption}))),Object.keys(this.state.tokensEarnings).map(function(n,i){var s=t.props.availableTokens[n],a=t.state.tokensEarnings[n],r=t.functionsUtil.BNify(Object.values(e).pop().perc),o=a.earningsYear.times(r),c=Math.min(1,parseFloat(a.earnings.div(o))),l=t.functionsUtil.getGlobalConfig(["stats","tokens",n,"color","rgb"]).join(",");return m.a.createElement(y.h,{id:"asset-".concat(n),flexDirection:"row",key:"asset-".concat(n),borderTop:"USD"===n?"1px solid ".concat(h.a.colors.divider):null},m.a.createElement(y.h,{width:[1,.93],position:"relative"},m.a.createElement(y.h,{width:1,height:"100%",position:"absolute",alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(y.h,{width:[.15,.1]}),m.a.createElement(y.h,{width:[.85,.9],height:"100%",flexDirection:"row"},Object.keys(e).map(function(i,s){var r=e[i],o=a.earningsYear.times(t.functionsUtil.BNify(r.perc)),c=t.functionsUtil.formatMoney(o,t.props.isMobile?2:o.lt(1)?3:2);return t.functionsUtil.getGlobalConfig(["stats","tokens",n,"conversionRateField"])&&(c="$ "+c),m.a.createElement(y.h,{pr:2,justifyContent:"flex-end",width:r.width,pt:"USD"===n?2:null,key:"asset-estimate-".concat(n,"-").concat(s),borderRight:"1px solid ".concat(h.a.colors.divider)},("USD"===n||s===Object.keys(e).length-1)&&m.a.createElement(y.u,{fontWeight:3,fontSize:[0,"1em"],style:{wordBreak:"break-all"},color:a.earnings.gte(o)?"copyColor":"legend"},c))}))),m.a.createElement(y.h,{width:1,zIndex:1,alignItems:"center",flexDirection:"row",justifyContent:"center",pt:"USD"===n?["2em","2.8em"]:"1.4em",pb:i<Object.keys(t.state.tokensEarnings).length-1?"1em":0},m.a.createElement(y.h,{width:[.15,.1],justifyContent:["flex-start","flex-end"]},m.a.createElement(y.u,{pr:[0,2],fontSize:[0,3],fontWeight:[3,4]},n)),m.a.createElement(y.h,{width:[.85,.9],alignItems:"center",flexDirection:"row",height:["20px","35px"],justifyContent:"flex-start"},m.a.createElement(y.h,{height:"100%",width:c,backgroundColor:"#ffffff"},m.a.createElement(y.h,{height:"100%",width:"100%",borderRadius:["0 20px 20px 0","0 35px 35px 0"],style:{background:"linear-gradient(90deg, rgba(".concat(l,",0) 0%, rgba(").concat(l,",0.1) 30%, rgba(").concat(l,",1) 100%)")}})),m.a.createElement(y.h,{pl:2,width:"auto",height:"100%",alignItems:"center",justifyContent:"flex-start"},m.a.createElement(y.l,{src:"images/tokens/".concat(n,".svg"),height:["1.4em","2.2em"]})),m.a.createElement(y.h,{pl:2,alignItems:"center"},"USD"!==n?m.a.createElement(g.a,Object.assign({},t.props,{token:n,tokenConfig:s,fieldInfo:{name:"earningsCounter",props:{decimals:t.props.isMobile?6:7,maxPrecision:t.props.isMobile?9:10,style:{color:t.props.theme.colors.copyColor,fontWeight:t.props.isMobile?500:700,fontSize:t.props.isMobile?"14px":"22px"}}}})):m.a.createElement(k.default,Object.assign({},t.props,{decimals:t.props.isMobile?6:7,maxPrecision:t.props.isMobile?9:10,counterStyle:{color:t.props.theme.colors.copyColor,fontWeight:t.props.isMobile?500:700,fontFamily:t.props.theme.fonts.sansSerif,fontSize:t.props.isMobile?"14px":"22px"}})))))),!t.props.isMobile&&m.a.createElement(y.h,{width:.07,alignItems:"flex-start",justifyContent:"flex-end"}))}),m.a.createElement(y.h,{flexDirection:"row"},m.a.createElement(y.h,{width:[1,.93],position:"relative"},m.a.createElement(y.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(y.h,{width:[.15,.1]}),m.a.createElement(y.h,{width:[.85,.9],flexDirection:"row"},Object.keys(e).map(function(t,n){var i=e[t];return m.a.createElement(y.h,{pt:2,pr:[1,2],justifyContent:"flex-end",width:i.width,key:"estimate-label-".concat(n),borderRight:"1px solid ".concat(h.a.colors.divider)},m.a.createElement(y.u,{fontWeight:3,fontSize:[0,2],color:"legend"},t))})))),!this.props.isMobile&&m.a.createElement(y.h,{width:.07,alignItems:"flex-start",justifyContent:"center"},m.a.createElement(y.u,{fontWeight:4,fontSize:3}))))}}]),e}(f.Component);e.default=w}}]);
//# sourceMappingURL=15.564732f3.chunk.js.map