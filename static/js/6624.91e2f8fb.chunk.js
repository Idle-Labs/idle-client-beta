"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[6624],{66624:function(e,t,l){l.r(t),l.d(t,{DynamicActionFields:function(){return k}});var i=l(93433),n=l(1413),o=l(45987),a=l(5128),r=l(7276),u=l(43098),s=l(87099),d=l(12056),c=l(86059),v=l(60062),m=l(29564),p=l(15542),f=l(1669),g=l(3498),y=l(20910),x=l(45263),Z=["assetId","field","amount","amountUsd","stakingPower"],A=function(e){var t,l,i,s,d=e.assetId,A=e.field,k=e.amount,S=e.amountUsd,h=e.stakingPower,b=(0,o.Z)(e,Z),w=(0,m.R)().locale,j=(0,f.w)(),D=j.stakingData,M=j.helpers.vaultFunctionsHelper,B=j.selectors,F=B.selectAssetById,I=B.selectVaultById,P=B.selectVaultGauge,U=(0,r.useMemo)((function(){return d&&F&&F(d)}),[d,F]),T=(0,r.useMemo)((function(){return U&&F&&F(U.underlyingId)}),[U,F]),C=(0,r.useMemo)((function(){return d&&I&&I(d)}),[d,I]),L=(0,r.useMemo)((function(){return d&&P&&P(d)}),[d,P]),E=(0,r.useMemo)((function(){return L&&F&&F(L.id)}),[L,F]),G=(0,r.useMemo)((function(){return(0,y.gA)(U.tvl).plus((0,y.d5)(k))}),[U,k]),_=(0,r.useMemo)((function(){return null===M||void 0===M?void 0:M.getVaultNewApr(U,C,(0,y.gA)(k))}),[U,C,k,M]),V=(0,r.useMemo)((function(){if((0,y.d5)(_).gt(0)){var e=(0,y.Bs)((0,y.d5)(_).div(100)).times(100),t=U.apyBreakdown?Object.keys(U.apyBreakdown||{}).filter((function(e){return"base"!==e})).reduce((function(e,t){switch(t){case"gauge":var l=null===E||void 0===E?void 0:E.gaugeData;if(l){var i=(0,y.d5)(null===l||void 0===l?void 0:l.totalSupply).plus((0,y.d5)(k)),n=(0,y.d5)(null===l||void 0===l?void 0:l.totalSupply).div(i),o=U.apyBreakdown[t].times(n);return e.plus(o)}return e.plus(U.apyBreakdown[t]);case"harvest":var a=(0,y.gA)(U.tvl).div(G),r=U.aprBreakdown[t].times(a);return e.plus((0,y.Bs)((0,y.gA)(r).div(100)).times(100));case"rewards":var u=(0,y.gA)(U.tvl).div(G),s=U.aprBreakdown[t].times(u);return e.plus((0,y.Bs)((0,y.gA)(s).div(100)).times(100));default:return e.plus(U.apyBreakdown[t])}}),(0,y.gA)(0)):(0,y.gA)(0);return(0,y.gA)(e).plus(t)}return(0,y.d5)(null===U||void 0===U?void 0:U.apy)}),[U,k,G,E,_]),q=(0,r.useMemo)((function(){return(0,y.d5)(S).gt(0)}),[S]),J=(0,r.useMemo)((function(){var e;return(0,y.d5)(null===U||void 0===U||null===(e=U.vaultPosition)||void 0===e?void 0:e.underlying.redeemable)}),[U]),O=(0,r.useMemo)((function(){var e;return(0,y.d5)(null===U||void 0===U||null===(e=U.vaultPosition)||void 0===e?void 0:e.usd.redeemable)}),[U]),z=(0,r.useMemo)((function(){var e,t;return"flags"in C&&(0,y.d5)(null===(e=C.flags)||void 0===e?void 0:e.withdrawFee).gt(0)?O.times(null===(t=C.flags)||void 0===t?void 0:t.withdrawFee):(0,y.gA)(0)}),[C,O]),H=(0,r.useMemo)((function(){var e;return a.Z.maximum(0,(0,y.d5)(null===U||void 0===U||null===(e=U.vaultPosition)||void 0===e?void 0:e.usd.earnings).minus(z))}),[z,U]),N=(0,r.useMemo)((function(){return a.Z.minimum(1,(0,y.d5)(S).div(O))}),[S,O]),R=(0,r.useMemo)((function(){return a.Z.minimum(H,N.times(H))}),[H,N]),K=(0,r.useMemo)((function(){var e;return a.Z.maximum(0,(0,y.d5)(null===U||void 0===U||null===(e=U.vaultPosition)||void 0===e?void 0:e.usd.earnings).times(null===U||void 0===U?void 0:U.fee))}),[U]),Q=(0,r.useMemo)((function(){return a.Z.minimum(K,(0,y.d5)(R).times(null===U||void 0===U?void 0:U.fee))}),[K,R,U]);C instanceof v.C&&(H=H.plus(Q),R=R.plus(Q));var W=q&&(0,y.d5)(k).lte(J),X="cta",Y="",$=null;switch(A){case"boost":var ee=V&&null!==U&&void 0!==U&&null!==(t=U.baseApr)&&void 0!==t&&t.gt(0)?V.div(null===U||void 0===U?void 0:U.baseApr):(0,y.gA)(0);$=(0,x.jsxs)(g.xv,(0,n.Z)((0,n.Z)({},b),{},{textStyle:"titleSmall",color:"primary",children:[ee.gt(9999)?">9999":ee.toFixed(2),"x"]}));break;case"epochEnd":$=(0,x.jsx)(g.xv,(0,n.Z)((0,n.Z)({},b),{},{textStyle:"titleSmall",color:"primary",children:(0,y.Jb)((null===U||void 0===U||null===(l=U.epochData)||void 0===l?void 0:l.end)||0,w)}));break;case"epochStart":$=(0,x.jsx)(g.xv,(0,n.Z)((0,n.Z)({},b),{},{textStyle:"titleSmall",color:"primary",children:(0,y.Jb)((null===U||void 0===U||null===(i=U.epochData)||void 0===i?void 0:i.start)||0,w)}));break;case"riskThreshold":$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({abbreviate:!1,decimals:0,textStyle:"titleSmall",color:"primary"},b),{},{value:null===U||void 0===U?void 0:U.epochData.riskThreshold}));break;case"overperformance":var te=(0,y.d5)(S).times((0,y.gA)(null===U||void 0===U?void 0:U.baseApr).div(100)),le=(0,y.d5)(S).times((0,y.gA)(null===U||void 0===U?void 0:U.apy).div(100)),ie=q?le.minus(te):null;$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:ie,suffix:"/year"}));break;case"newApy":$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:V}));break;case"totalGain":$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({decimals:R.lt(1)?4:2,textStyle:"titleSmall",color:"primary"},b),{},{value:W?R:null}));break;case"fee":$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({decimals:Q.lt(1)?4:2,textStyle:"titleSmall",color:"primary"},b),{},{value:W?-Q:null}));break;case"withdrawFee":(0,y.d5)(null===(s=C.flags)||void 0===s?void 0:s.withdrawFee).gt(0)&&(X="orange",$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({decimals:z.lt(1)?4:2,textStyle:"titleSmall",color:"orange"},b),{},{value:W?-z:null})));break;case"depositLimit":X="orange";var ne=a.Z.maximum(0,(0,y.d5)(U.limit).minus(U.totalTvl).minus((0,y.d5)(k)));$=(0,x.jsx)(c.Amount,(0,n.Z)((0,n.Z)({suffix:" ".concat(T.token),decimals:2,textStyle:"titleSmall",color:X},b),{},{value:ne}));break;case"netGain":var oe=a.Z.minimum(H.minus(Q),(0,y.d5)(R).minus(Q));$=(0,x.jsx)(c.Amount.Usd,(0,n.Z)((0,n.Z)({decimals:oe.lt(1)?4:2,textStyle:"titleSmall",color:"primary"},b),{},{value:W?oe:null}));break;case"coverage":var ae=F(null===C||void 0===C?void 0:C.vaultConfig.Tranches.BB.address),re=ae.tvl&&G?ae.tvl.div(G).times(100):0;$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:re}));break;case"stakingPoolShare":if(D){var ue=(0,y.d5)(k).div(D.stkIDLE.totalSupply.plus((0,y.d5)(k))).times(100);$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:ue}))}break;case"stkIDLE":case"stkIDLEAfterIncrease":$=(0,x.jsx)(c.Amount,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary",suffix:" stkIDLE"},b),{},{value:k}));break;case"currentFeeDiscount":var se=(0,y.d5)(null===D||void 0===D?void 0:D.feeDiscount);Y=se.lte(0)?"orange":"brightGreen",$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({color:Y,textStyle:"titleSmall"},b),{},{value:se}));break;case"feeDiscount":var de=(0,y.SL)(k);Y=de.lte(0)?"orange":"brightGreen",$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({color:Y,textStyle:"titleSmall"},b),{},{value:de}));break;case"feeDiscountTier":$=(0,x.jsx)(c.Amount,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:1}));break;case"stakingApy":if(D){var ce=(0,y.d5)(h).times(D.maxApr);$=(0,x.jsx)(c.Amount.Percentage,(0,n.Z)((0,n.Z)({textStyle:"titleSmall",color:"primary"},b),{},{value:ce}))}break;default:return null}return $?(0,x.jsxs)(g.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,x.jsxs)(g.Ug,{spacing:2,alignItems:"center",children:[(0,x.jsx)(p.Translation,{component:g.xv,translation:"dynamicActionFields.".concat(A),textStyle:"captionSmall",color:X}),["feeDiscount","currentFeeDiscount"].includes(A)&&(0,x.jsx)(u.nfF,{size:16,color:"orange"})]}),$]}):null},k=function(e){var t=(0,f.w)(),l=t.stakingData,o=t.selectors,a=o.selectAssetById,u=o.selectVaultById,c=e.assetId,v=e.action,m=(0,r.useMemo)((function(){return c&&a&&a(c)}),[c,a]),p=(0,r.useMemo)((function(){return c&&u&&u(c)}),[c,u]),Z=(0,r.useMemo)((function(){return(null===p||void 0===p?void 0:p.type)&&d.A[p.type]}),[p]),k=(0,r.useMemo)((function(){return(0,y.d5)(null===m||void 0===m?void 0:m.limit).lt(s.jq)?(0,y.d5)(null===m||void 0===m?void 0:m.limit):(0,y.gA)(0)}),[m]),S=(0,r.useMemo)((function(){return!!k.gt(0)&&(0,y.gA)(null===m||void 0===m?void 0:m.totalTvl).gte(k)}),[m,k]),h=(0,r.useMemo)((function(){var e,t,n;if(null===Z||void 0===Z||null===(e=Z.dynamicActionFields)||void 0===e||!e[v])return null;var o=null===Z||void 0===Z?void 0:Z.dynamicActionFields[v];"deposit"===v&&null!==m&&void 0!==m&&m.epochData&&((0,y.qF)(m.epochData.start).isBefore(Date.now())?o=["riskThreshold","epochEnd"].concat((0,i.Z)(o)):(0,y.qF)(m.epochData.start).isAfter(Date.now())&&(o=["riskThreshold","epochStart"].concat((0,i.Z)(o))));var a=p&&"flags"in p&&(null===(t=p.flags)||void 0===t?void 0:t.showLimitCap),r=p&&"flags"in p&&(null===(n=p.flags)||void 0===n?void 0:n.feeDiscountEnabled)&&(0,y.d5)(null===l||void 0===l?void 0:l.feeDiscount).gt(0);return a&&"deposit"===v&&k.gt(0)&&!S&&(o=["depositLimit"].concat((0,i.Z)(o))),r&&"deposit"===v&&-1===o.indexOf("currentFeeDiscount")&&(o=[].concat((0,i.Z)(o),["currentFeeDiscount"])),o}),[v,p,m,Z,S,l,k]);return h?(0,x.jsx)(g.gC,{spacing:2,width:"full",children:h.map((function(t){return(0,x.jsx)(A,(0,n.Z)((0,n.Z)({},e),{},{field:t}),"field_".concat(t))}))}):null}}}]);