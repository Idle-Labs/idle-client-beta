(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{4751:function(e,t,n){"use strict";var o=n(1),a=n.n(o),i=n(6),s=n(11),r=n(12),l=n(15),c=n(14),u=n(18),p=n(175),h=n(0),d=n.n(h),m=n(182),f=n(50),b=n(4),g=function(e){function t(){var e,n;Object(s.a)(this,t);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(a)))).state={buyModalOpened:!1},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"setBuyModalOpened",value:function(e){this.setState({buyModalOpened:e})}},{key:"componentWillMount",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.menu.length)return null;var t=this.props.menu.filter(function(t){var n=void 0===t.mobile||t.mobile;return!e.props.isMobile||n});return t.length?d.a.createElement(b.h,{p:0,flexDirection:["row","column"]},!this.props.isMobile&&d.a.createElement(b.h,{p:3,mb:3,flexDirection:"row",alignItems:"center",justifyContent:"center"},d.a.createElement(m.b,{to:"/"},d.a.createElement(b.l,{position:"relative",height:["35px","38px"],src:"images/logo-gradient.svg"}))),t.map(function(n,o){var a=n.isExternalLink?p.a:m.b;return d.a.createElement(b.b,{my:[0,3],key:"menu-".concat(o),width:[1/t.length,"auto"]},d.a.createElement(a,{to:n.route,href:n.route,style:{textDecoration:"none"}},d.a.createElement(b.h,{p:[2,3],borderRadius:[0,2],flexDirection:"row",alignItems:"center",backgroundColor:n.selected?"#f3f6ff":"transparent",boxShadow:n.selected?"0px 0px 0px 1px rgba(0,54,255,0.3)":null},d.a.createElement(b.h,{width:1,alignItems:"center",flexDirection:["column","row"],justifyContent:["center","flex-start"]},n.image&&d.a.createElement(b.l,{mr:[0,3],ml:[0,2],mb:[1,0],align:"center",src:n.selected?n.image:n.imageInactive?n.imageInactive:n.image,height:["1.2em","1.6em"]}),n.icon&&d.a.createElement(b.k,{mr:[0,3],ml:[0,2],mb:[1,0],align:"center",name:n.icon,size:e.props.isMobile?"1.4em":"1.6em",color:n.selected?n.bgColor:"copyColor"}),d.a.createElement(b.u,{fontWeight:3,color:"copyColor",textAlign:"center",fontSize:["11px",2],style:{whiteSpace:"nowrap"}},n.label)))))})):null}}]),t}(h.Component);t.a=g},4946:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),i=n(6),s=n(11),r=n(12),l=n(15),c=n(14),u=n(18),p=n(163),h=n(4),d=n(0),m=n.n(d),f=n(50),b=n(4751),g=m.a.lazy(function(){return Promise.all([n.e(7),n.e(17)]).then(n.bind(null,4864))}),v=m.a.lazy(function(){return n.e(18).then(n.bind(null,4823))}),k=m.a.lazy(function(){return n.e(19).then(n.bind(null,4824))}),w=m.a.lazy(function(){return Promise.resolve().then(n.bind(null,69))}),y=m.a.lazy(function(){return Promise.resolve().then(n.bind(null,32))}),x=m.a.lazy(function(){return n.e(20).then(n.bind(null,4861))}),S=m.a.lazy(function(){return n.e(21).then(n.bind(null,4825))}),T=m.a.lazy(function(){return n.e(3).then(n.bind(null,4765))}),M=m.a.lazy(function(){return n.e(22).then(n.bind(null,4826))}),I=m.a.lazy(function(){return n.e(23).then(n.bind(null,4827))}),z=m.a.lazy(function(){return Promise.all([n.e(5),n.e(4)]).then(n.bind(null,4770))}),C=function(e){function t(){var e,n;Object(s.a)(this,t);for(var o=arguments.length,r=new Array(o),u=0;u<o;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={menu:[],baseRoute:null,clickEvent:null,activeModal:null,currentRoute:null,pageComponent:null,currentSection:null,selectedSection:null,tokensToMigrate:null,showResetButton:!1,selectedSubsection:null,oldIdleTokensToMigrate:null,protocolsTokensBalances:null},n.timeoutId=null,n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.openTooltipModal=function(e,t){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:e,eventLabel:"TooltipModal"}),n.setState({modalTitle:e,modalContent:t},function(){n.setActiveModal("tooltip")})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.logout=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.setConnector("Infura","Infura"),e.next=3,n.props.initWeb3("Infura");case 3:case"end":return e.stop()}},e,this)})),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props),window.functionsUtil=this.functionsUtil}},{key:"loadMenu",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,o,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),n=this.functionsUtil.getGlobalConfig(["strategies"]),o=Object.keys(n).filter(function(e){return!n[e].comingSoon}).map(function(e){return{submenu:[],color:"#fff",selected:!1,route:t+"/"+e,label:n[e].title,image:n[e].icon,imageInactive:n[e].iconInactive,bgColor:n[e].color,component:n[e].component}}),(i=this.functionsUtil.getGlobalConfig(["curve"])).enabled&&(s=Object.assign({submenu:[],selected:!1,component:x},i.params),o.push(s)),o.push({icon:"Equalizer",label:"Stats",bgColor:"#21f36b",color:"dark-gray",component:g,selected:!1,route:"/dashboard/stats",submenu:[]}),o.push({icon:"Build",label:"Tools",color:"dark-gray",component:v,selected:!1,route:"/dashboard/tools",bgColor:this.props.theme.colors.primary,submenu:Object.values(this.functionsUtil.getGlobalConfig(["tools"])).filter(function(e){return e.enabled})}),o.push({submenu:[],icon:"Forum",mobile:!1,label:"Forum",selected:!1,component:null,color:"dark-gray",bgColor:"#ff0000",isExternalLink:!0,route:this.functionsUtil.getGlobalConfig(["forumURL"])}),e.next=10,this.setState({menu:o});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadParams",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,o,i,s,r,l,c,u,p,h,d,m,f,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.match.params,n=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),o=n,i=null,s=null,r=null,l=null,t.section&&(r=t.section,c=t.param1,u=t.param2,p=Object.keys(this.props.availableStrategies).includes(r.toLowerCase()),h=c&&Object.keys(this.props.availableStrategies).includes(c.toLowerCase()),p||h?(o+="/"+(l=p?r:c),d=c&&Object.keys(this.props.availableStrategies[l]).includes(c.toUpperCase()),m=u&&Object.keys(this.props.availableStrategies[l]).includes(u.toUpperCase()),(d||m)&&(s=d?c.toUpperCase():u.toUpperCase(),o+="/"+s,p&&(i=k))):(o+="/"+t.section,t.param1&&t.param1.length&&(o+="/"+t.param1))),f=this.state.menu,b=null,g=null,f.forEach(function(e){e.selected=!1;var a=n+"/"+t.section;o.toLowerCase()===e.route.toLowerCase()||!e.submenu.length&&e.route.toLowerCase()===a.toLowerCase()?(e.selected=!0,null===i&&(i=e.component)):e.submenu.length&&e.submenu.forEach(function(t){t.selected=!1,(e.route+"/"+t.route).toLowerCase()===o.toLowerCase()&&(e.selected=!0,t.selected=!0,null===i&&(i=t.component?t.component:e.component)),t.selected&&(g=t)}),e.selected&&(b=e)}),i){e.next=14;break}return e.abrupt("return",this.goToSection("/",!1));case 14:return e.next=16,this.props.setStrategyToken(l,s);case 16:return e.next=18,this.setState({menu:f,params:t,baseRoute:n,currentRoute:o,pageComponent:i,currentSection:r,selectedSection:b,selectedSubsection:g});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadMenu();case 3:this.loadParams();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.timeoutId=window.setTimeout(function(){t.props.accountInizialized&&t.props.contractsInitialized||t.setState({showResetButton:!0})},2e4),this.props.web3){e.next=5;break}return e.abrupt("return",this.props.initWeb3());case 5:if(this.props.accountInizialized){e.next=9;break}return e.abrupt("return",this.props.initAccount());case 9:if(this.props.contractsInitialized){e.next=11;break}return e.abrupt("return",this.props.initializeContracts());case 11:return this.loadUtils(),e.next=14,this.loadMenu();case 14:this.loadParams(),this.checkModals();case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var o,i,s,r,l,c,u=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),o=t.match.params,i=this.props.match.params,JSON.stringify(o)===JSON.stringify(i)){e.next=6;break}return e.next=6,this.setState({pageComponent:null},function(){u.loadParams()});case 6:s=t.account!==this.props.account,r=this.props.selectedStrategy&&t.selectedStrategy!==this.props.selectedStrategy,l=this.props.accountInizialized&&t.accountInizialized!==this.props.accountInizialized,c=this.props.contractsInitialized&&t.contractsInitialized!==this.props.contractsInitialized,(s||l||c||r)&&this.checkModals();case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkModals",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selectedToken&&this.props.accountInizialized&&this.props.contractsInitialized&&this.props.availableStrategies&&this.props.availableTokens){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.checkTokensToMigrate();case 4:return e.next=6,this.checkWelcomeModal();case 6:return e.next=8,this.checkProtocolsTokensBalances();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkTokensToMigrate",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===this.functionsUtil.getStoredItem("dontShowUpgradeModal",!1,null),!this.props.selectedToken&&t&&this.props.availableTokens){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.functionsUtil.getTokensToMigrate();case 5:return n=e.sent,e.next=8,this.functionsUtil.getProtocolsTokensBalances("idle");case 8:if(o=e.sent,!(n&&Object.keys(n).length>0||o&&Object.keys(o).length>0)){e.next=14;break}if("upgrade","upgrade"===this.state.activeModal){e.next=14;break}return this.setState({activeModal:"upgrade",tokensToMigrate:n,oldIdleTokensToMigrate:o}),e.abrupt("return","upgrade");case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkWelcomeModal",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,o,i,s,r,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(!this.props.account||null!==this.state.activeModal){e.next=10;break}if(t=!1,(n=this.functionsUtil.getGlobalConfig(["modals","welcome"])).enabled&&localStorage&&(o=(new Date).getTime(),i=this.props.account.toLowerCase(),(s=localStorage.getItem("lastLogin")?JSON.parse(localStorage.getItem("lastLogin")):{})[i]?s[i].signedUp||(r=parseInt(s[i].lastTime),t=(o-r)/1e3>=n.frequency):(s[i]={signedUp:!1,lastTime:o},t=!0),t&&(s[i].lastTime=o,this.functionsUtil.setLocalStorage("lastLogin",JSON.stringify(s)))),l=t?"welcome":this.state.activeModal,this.state.activeModal===l){e.next=10;break}return this.setState({activeModal:l}),e.abrupt("return",l);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkProtocolsTokensBalances",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,o,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(t=this.functionsUtil.getGlobalConfig(["modals","migrate","enabled"]),n=null===this.functionsUtil.getStoredItem("dontShowMigrateModal",!1,null),null!==this.state.activeModal||!t||!n||this.state.protocolsTokensBalances){e.next=12;break}return e.next=7,this.functionsUtil.getProtocolsTokensBalances();case 7:return o=e.sent,i=o&&Object.keys(o).length>0?"migrate":null,s={activeModal:i,protocolsTokensBalances:o},this.setState(s),e.abrupt("return",i);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"goToSection",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e=e.replace(this.state.baseRoute+"/",""));var n=t?this.state.baseRoute+"/"+e:e;window.location.hash=n,this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"goToSection",eventLabel:n}),window.scrollTo(0,0)}},{key:"changeToken",value:function(e){if(e=e.toUpperCase(),Object.keys(this.props.availableTokens).includes(e)){var t=[];this.state.currentSection.toLowerCase()!==this.props.selectedStrategy.toLowerCase()&&t.push(this.state.currentSection),t.push(this.props.selectedStrategy),t.push(e),this.goToSection(t.join("/"))}}},{key:"propagateClickEvent",value:function(e){this.setState({clickEvent:e.target})}},{key:"render",value:function(){var e=m.a.createElement(p.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{minHeight:"50vh",aligItems:"center",flexDirection:"column"},text:"Loading Dashboard..."}),t=this.state.pageComponent?this.state.pageComponent:null;return m.a.createElement(h.h,{width:"100%",position:"fixed",flexDirection:"row",backgroundColor:["dashboardBg","white"],height:[window.innerHeight-61+"px","100vh"]},m.a.createElement(h.h,{bottom:0,zIndex:1,width:[1,1/6],flexDirection:"column",position:["fixed","relative"]},m.a.createElement(h.d,{p:[0,3],width:["100vw","auto"],height:["auto","100vh"]},m.a.createElement(b.a,Object.assign({},this.props,{menu:this.state.menu})))),m.a.createElement(h.h,{py:3,px:[3,5],mb:0,width:[1,5/6],style:{overflowY:"scroll",overflowX:"hidden"},flexDirection:"columns",backgroundColor:"dashboardBg"},m.a.createElement(d.Suspense,{fallback:e},this.props.accountInizialized&&this.props.contractsInitialized&&t?m.a.createElement(h.h,{width:1,flexDirection:"column"},m.a.createElement(z,Object.assign({clickEvent:this.state.clickEvent,goToSection:this.goToSection.bind(this)},this.props)),t&&m.a.createElement(t,Object.assign({},this.props,{match:{params:{}},urlParams:this.state.params,changeToken:this.changeToken.bind(this),goToSection:this.goToSection.bind(this),selectedSection:this.state.selectedSection,selectedSubsection:this.state.selectedSubsection,openTooltipModal:this.openTooltipModal.bind(this)}))):m.a.createElement(h.h,{width:1,minHeight:"50vh",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.showResetButton?m.a.createElement(y,{cardProps:{p:3,mt:3,width:[1,.35]}},m.a.createElement(h.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(h.k,{size:"2.3em",name:"Warning",color:"cellText"}),m.a.createElement(h.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle can't connect to your wallet!",m.a.createElement("br",null),"Make sure that your wallet is unlocked and try again."),m.a.createElement(w,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.logout.bind(this)},"Logout"))):m.a.createElement(p.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{my:3,flexDirection:"column"},text:this.props.accountInizialized?this.props.contractsInitialized?"Loading assets...":"Loading contracts...":"Loading account..."})))),m.a.createElement(d.Suspense,{fallback:null},m.a.createElement(I,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),tokensToMigrate:this.state.tokensToMigrate,isOpen:"upgrade"===this.state.activeModal,oldIdleTokensToMigrate:this.state.oldIdleTokensToMigrate})),m.a.createElement(M,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),isOpen:"migrate"===this.state.activeModal,protocolsTokensBalances:this.state.protocolsTokensBalances})),m.a.createElement(T,{closeModal:this.resetModal,title:this.state.modalTitle,content:this.state.modalContent,isOpen:"tooltip"===this.state.activeModal}),m.a.createElement(S,{closeModal:this.resetModal,account:this.props.account,simpleID:this.props.simpleID,network:this.props.network.current,tokenName:this.props.selectedToken,initSimpleID:this.props.initSimpleID,baseTokenName:this.props.selectedToken,isOpen:"welcome"===this.state.activeModal})))}}]),t}(d.Component);t.default=C}}]);
//# sourceMappingURL=10.5b43aea5.chunk.js.map