(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{4824:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),i=n(35),o=n(36),l=n(6),r=n(11),c=n(12),p=n(15),u=n(14),h=n(18),d=n(282),f=n(4),m=n(163),k=n(0),b=n.n(k),T=n(50),v=b.a.lazy(function(){return n.e(6).then(n.bind(null,236))}),g=b.a.lazy(function(){return n.e(0).then(n.bind(null,4792))}),y=b.a.lazy(function(){return Promise.resolve().then(n.bind(null,591))}),w=b.a.lazy(function(){return n.e(34).then(n.bind(null,4856))}),E=b.a.lazy(function(){return Promise.all([n.e(40),n.e(35)]).then(n.bind(null,4863))}),B=b.a.lazy(function(){return n.e(36).then(n.bind(null,4742))}),O=b.a.lazy(function(){return n.e(2).then(n.bind(null,1114))}),U=b.a.lazy(function(){return Promise.all([n.e(7),n.e(37)]).then(n.bind(null,4860))}),j=function(e){function t(){var e,n;Object(r.a)(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={tokenFees:{},tokenBalance:{},tokenApproved:{},activeModal:null,govTokensBalance:{},idleTokenBalance:{},redeemableBalance:{},govTokensDisabled:{},availableGovTokens:{},tokenFeesPercentage:{},componentMounted:!1},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new T.a(this.props)}},{key:"loadTokensInfo",value:function(){var e=Object(l.a)(a.a.mark(function e(){var t,n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.account){e.next=7;break}return t=Object(o.a)({},this.state),e.next=4,this.functionsUtil.asyncForEach(Object.keys(this.props.availableTokens),function(){var e=Object(l.a)(a.a.mark(function e(s){var o,l,r,c,p,u,h,d,f,m,k;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.props.availableTokens[s],(l={})[s]=o,e.next=5,Promise.all([n.functionsUtil.getTokenFees(o),n.functionsUtil.getTokenBalance(s,n.props.account),n.functionsUtil.getUserTokenFees(o,n.props.account),n.functionsUtil.genericContractCall(o.idle.token,"tokenPrice"),n.functionsUtil.getTokenBalance(o.idle.token,n.props.account),n.functionsUtil.checkTokenApproved(s,o.idle.address,n.props.account),n.functionsUtil.getGovTokensUserTotalBalance(n.props.account,l,"DAI")]);case 5:r=e.sent,c=Object(i.a)(r,7),p=c[0],u=c[1],h=c[2],d=c[3],f=c[4],m=c[5],k=c[6],t.tokenFees[s]=h,t.tokenBalance[s]=u,t.tokenApproved[s]=m,t.idleTokenBalance[s]=f,t.govTokensBalance[s]=k,t.tokenFeesPercentage[s]=p,t.govTokensDisabled[s]=o.govTokensDisabled,t.redeemableBalance[s]=f?n.functionsUtil.fixTokenDecimals(f.times(d),o.decimals):n.functionsUtil.BNify(0);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 4:t.availableGovTokens=this.functionsUtil.getTokenGovTokens(this.props.tokenConfig),t.componentMounted=!0,this.setState(t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=Object(l.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(l.a)(a.a.mark(function e(t,n){var s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),s=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,(t.account!==this.props.account||s)&&this.loadTokensInfo();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=b.a.createElement(m.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{minHeight:"70vh",aligItems:"center",flexDirection:"column"},text:"Loading asset..."}),n=this.props.account&&this.state.idleTokenBalance[this.props.selectedToken]&&this.functionsUtil.BNify(this.state.idleTokenBalance[this.props.selectedToken]).gt(0);return b.a.createElement(f.b,{width:1},b.a.createElement(k.Suspense,{fallback:t},b.a.createElement(f.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},b.a.createElement(f.h,{width:.5},b.a.createElement(v,{isMobile:this.props.isMobile,path:[this.props.selectedToken],handleClick:function(t){return e.props.goToSection(e.props.selectedStrategy)},text:this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])})),b.a.createElement(f.h,{width:.5,justifyContent:"flex-end"},b.a.createElement(B,Object.assign({icon:"Add"},this.props,{text:"Add funds",handleClick:function(t){return e.setActiveModal("buy")}})))),b.a.createElement(d.a,{mb:[3,4]},"Deposit / Redeem"),b.a.createElement(f.h,{width:1},b.a.createElement(E,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken],tokenBalance:this.state.tokenBalance[this.props.selectedToken],tokenApproved:this.state.tokenApproved[this.props.selectedToken],govTokensBalance:this.state.govTokensBalance[this.props.selectedToken],idleTokenBalance:this.state.idleTokenBalance[this.props.selectedToken],redeemableBalance:this.state.redeemableBalance[this.props.selectedToken],tokenFeesPercentage:this.state.tokenFeesPercentage[this.props.selectedToken]}))),n&&b.a.createElement(f.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},b.a.createElement(d.a,{my:[3,4]},"Funds Overview"),b.a.createElement(w,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken]}))),n&&this.props.account&&!this.state.govTokensDisabled[this.props.selectedToken]&&Object.keys(this.state.availableGovTokens).length>0&&b.a.createElement(f.h,{width:1,id:"yield-farming",flexDirection:"column"},b.a.createElement(d.a,{my:[3,4]},"Yield Farming"),b.a.createElement(g,Object.assign({enabledTokens:Object.keys(this.state.availableGovTokens),cols:[{title:"TOKEN",props:{width:[.3,.15]},fields:[{name:"icon",props:{mr:2,height:["1.4em","2.3em"]}},{name:"tokenName"}]},{mobile:!1,title:"BALANCE",props:{width:[.33,.25]},fields:[{name:"tokenBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"REDEEMABLE",desc:this.functionsUtil.getGlobalConfig(["messages","govTokenRedeemableBalance"]),props:{width:[.35,.3],justifyContent:["center","flex-start"]},fields:[{name:"redeemableBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"DISTRIBUTION",desc:this.functionsUtil.getGlobalConfig(["messages","userDistributionSpeed"]),props:{width:[.35,.3]},fields:[{name:"userDistributionSpeed",props:{decimals:6}}]}]},this.props,{availableTokens:this.state.availableGovTokens}))),this.props.account&&b.a.createElement(f.h,{mb:[3,4],width:1,flexDirection:"column",id:"estimated-earnings-container"},b.a.createElement(d.a,{my:[3,4]},"Estimated earnings"),b.a.createElement(U,this.props)),this.props.account&&b.a.createElement(f.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},b.a.createElement(d.a,{my:[3,4]},"Transactions"),b.a.createElement(O,Object.assign({},this.props,{enabledTokens:[this.props.selectedToken],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]}))),b.a.createElement(y,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.props.selectedToken,isOpen:"buy"===this.state.activeModal}))))}}]),t}(k.Component);t.default=j}}]);
//# sourceMappingURL=19.dd15188c.chunk.js.map