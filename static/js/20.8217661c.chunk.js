(window.webpackJsonp=window.webpackJsonp||[]).push([[20,2,6,30],{1114:function(e,t,n){"use strict";n.r(t);var a=n(36),i=n(1),s=n.n(i),o=n(6),r=n(11),c=n(12),l=n(15),u=n(14),p=n(18),h=n(0),f=n.n(h),m=n(4735),d=n(163),g=n(4736),v=n(50),b=n(4),k=n(301),x=n(99),y=n(129),w=n(4752),C=n.n(w),S=n(32),T=n(4734),j=function(e){function t(){var e,n;Object(r.a)(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={maxWidth:.4,minWidth:.18,maxHeight:425,isOpened:!1,activeFilters:{status:null,assets:null,actions:null}},n.setFilter=function(e,t){n.setState(function(n){return{activeFilters:Object(a.a)({},n.activeFilters,Object(x.a)({},e,t))}})},n.applyFilters=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];"function"===typeof n.props.applyFilters&&n.props.applyFilters(n.state.activeFilters),e&&n.toggleOpened()},n.resetFilter=function(e){n.setState(function(t){return{activeFilters:Object(a.a)({},t.activeFilters,Object(x.a)({},e,null))}},function(){n.applyFilters(!1)})},n.resetFilters=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.setState({activeFilters:{status:null,assets:null,actions:null}},function(){"function"===typeof n.props.resetFilters&&n.props.resetFilters(),e&&n.toggleOpened()})},n.toggleOpened=function(){n.setState(function(e){return{isOpened:!e.isOpened}})},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return f.a.createElement(b.h,{mb:3,top:0,width:1,zIndex:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center",position:["relative","absolute"]},f.a.createElement(S.default,{cardProps:{py:2,px:3,width:[1,this.state.isOpened?this.state.maxWidth:this.state.minWidth],style:{transition:"width 0.3s ease-in-out"}},isInteractive:!this.state.isOpened,handleClick:this.state.isOpened?null:this.toggleOpened},f.a.createElement(b.h,{width:1,style:{cursor:"pointer"},alignItems:"center",flexDirection:"row",justifyContent:"space-between",onClick:this.state.isOpened?this.toggleOpened:null},f.a.createElement(b.u,{fontSize:2,fontWeight:500,color:"copyColor"},"Filters"),f.a.createElement(b.k,{color:"copyColor",size:this.props.isMobile?"1.3em":"1.5em",name:this.state.isOpened?"Close":"Tune"})),f.a.createElement(b.h,{flexDirection:"column",style:{overflow:"hidden",transition:"max-height 0.3s ease-in-out",maxHeight:this.state.isOpened?this.state.maxHeight:0}},f.a.createElement(b.h,{mt:2,py:2,width:1,flexDirection:"row",borderTop:"1px solid ".concat(y.a.colors.divider)},Object.keys(this.props.filters).map(function(t){var n=e.props.filters[t];return f.a.createElement(b.h,{flexDirection:"column",key:"filter_".concat(t),style:{flexBasis:"0",flex:"1 1 0px"}},f.a.createElement(T.a,{pb:2,fontWeight:3,fontSize:[0,2],color:"cellText"},t.toUpperCase()),Object.keys(n).map(function(a){var i=n[a],s=e.state.activeFilters[t]===a;return f.a.createElement(b.s,{my:2,fontSize:[0,2],label:i,checked:s,className:C.a.radioBtn,key:"filter_".concat(t,"_").concat(a),onChange:function(n){return e.setFilter(t,a)}})}))})),f.a.createElement(b.h,{flexDirection:"row"},f.a.createElement(b.c.Text,{fontWeight:4,fontSize:[2,3],mainColor:"copyColor",onClick:this.applyFilters},"Apply filters"),f.a.createElement(b.c.Text,{ml:3,fontWeight:4,fontSize:[2,3],mainColor:"copyColor",onClick:this.resetFilters},"Reset")))),!this.state.isOpened&&this.props.activeFilters&&Object.values(this.props.activeFilters).filter(function(e){return null!==e}).length>0&&f.a.createElement(b.h,{mt:3,width:1,flexDirection:["column","row"],alignItems:["flex-start","flex-end"],justifyContent:["flex-end","flex-start"]},Object.keys(this.props.activeFilters).map(function(t){var n=e.props.activeFilters[t];if(null!==n){var a=e.props.filters[t][n];return f.a.createElement(S.default,{cardProps:{py:2,px:3,mb:[2,0],mr:[0,3],width:[1,e.state.minWidth]},isInteractive:!0,key:"filter_".concat(t)},f.a.createElement(b.h,{width:1,style:{cursor:"pointer"},alignItems:"center",flexDirection:"row",justifyContent:"space-between",onClick:function(n){return e.resetFilter(t)}},f.a.createElement(b.u,{fontSize:2,fontWeight:500,color:"cellText",style:{textTransform:"capitalize"}},a),f.a.createElement(b.k,{name:"Close",color:"cellText",size:e.props.isMobile?"1.3em":"1.5em"})))}return null}),f.a.createElement(b.n,{mt:[2,0],fontSize:[3,2],fontWeight:[3],color:"dark-gray",hoverColor:"copyColor",textAlign:["center","left"],onClick:function(t){return e.resetFilters(!1)}},"Clear all filters")))}}]),t}(h.Component),O=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={page:1,prevTxs:{},txsPerPage:5,loading:!1,totalTxs:null,totalPages:null,activeFilters:{status:null,assets:null,actions:null},filters:{actions:{deposit:"Deposit",redeem:"Redeem",send:"Send",receive:"Receive",migrate:"Migrate",swap:"Swap-In",swapout:"Swap-Out",withdraw:"Withdraw"},status:{completed:"Completed",pending:"Pending",failed:"Failed"},assets:{}},renderedTxs:null,processedTxs:null,lastBlockNumber:null},n.functionsUtil=null,n.applyFilters=function(e){n.setState({activeFilters:e},function(){n.processTxs()})},n.resetFilters=function(){n.setState({activeFilters:{status:null,assets:null,actions:null}},function(){n.processTxs()})},n.processTxs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=e||n.state.page;var t=Object.keys(n.state.filters.actions).map(function(e){return e.toLowerCase()}),a=Object.values(n.state.prevTxs).filter(function(e){return!!parseFloat(e.value)}).filter(function(e){return(null===n.state.activeFilters.status||e.status.toLowerCase()===n.state.activeFilters.status.toLowerCase())&&(null===n.state.activeFilters.assets||e.token.toLowerCase()===n.state.activeFilters.assets.toLowerCase())&&t.includes(e.action.toLowerCase())&&(null===n.state.activeFilters.actions||e.action.toLowerCase()===n.state.activeFilters.actions.toLowerCase())}).sort(function(e,t){return e.timeStamp>t.timeStamp?-1:1}),i=a.length,s=Math.ceil(i/n.state.txsPerPage),o=[];a.forEach(function(t,a){var i=t.token,s=n.props.availableTokens[i],r=Math.min(s.decimals,8),c=new Date(1e3*t.timeStamp),l=t.action?t.action:n.functionsUtil.getTxAction(t,s),u=parseFloat(t.tokenAmount),p=u?n.props.isMobile?u.toFixed(4):u.toFixed(r):"-",h=n.functionsUtil.strToMoment(c);t.status=t.status?t.status:"Completed",t.action=l,t.momentDate=h,t.amount=p,a>=(e-1)*n.state.txsPerPage&&a<(e-1)*n.state.txsPerPage+n.state.txsPerPage&&o.push(t)});n.setState({loading:!1,totalTxs:i,totalPages:s,processedTxs:o})},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new v.a(this.props)}},{key:"prevPage",value:function(e){e&&e.preventDefault();var t=Math.max(1,this.state.page-1);this.setState({page:t})}},{key:"nextPage",value:function(e){e&&e.preventDefault();var t=Math.min(this.state.totalPages,this.state.page+1);this.processTxs(t),this.setState({page:t})}},{key:"componentDidMount",value:function(){var e=Object(o.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadTxs();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(o.a)(s.a.mark(function e(t,n){var a,i=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=JSON.stringify(t.transactions)!==JSON.stringify(this.props.transactions),!(JSON.stringify(t.enabledTokens)!==JSON.stringify(this.props.enabledTokens))&&!a){e.next=6;break}return this.setState({page:1,prevTxs:{}},function(){i.loadTxs()}),e.abrupt("return",!1);case 6:n.page!==this.state.page&&this.processTxs();case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTxs",value:function(){var e=Object(o.a)(s.a.mark(function e(t){var n,i,o,r,c,l,u,p,h,f=this,m=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.length>1&&void 0!==m[1]?m[1]:"latest",this.props.account){e.next=3;break}return e.abrupt("return",!1);case 3:return t=t||0,this.setState({loading:!0}),n=this.functionsUtil.getGlobalConfig(["network","firstBlockNumber"]),i=Object(a.a)({},this.state.prevTxs),o=Math.max(n,this.state.lastBlockNumber),(r=this.props.enabledTokens)&&r.length||(r=Object.keys(this.props.availableTokens)),c=Object(a.a)({},this.state.filters.assets),r.forEach(function(e){c[e]=e}),l=Object(a.a)({},this.state.filters.actions),(u="undefined"!==typeof this.props.enabledActions?this.props.enabledActions:[]).length&&(l={},u.forEach(function(e){l[e.toLowerCase()]=e})),e.next=17,this.functionsUtil.getEtherscanTxs(this.props.account,o,"latest",r);case 17:return(p=e.sent)&&p.length&&p.forEach(function(e){e.hashKey?i[e.hashKey]=e:i["t".concat(e.timeStamp)]=e}),(h=Object.values(i).pop())&&h.blockNumber&&(!this.state.lastBlockNumber||h.blockNumber>this.state.lastBlockNumber)&&(o=parseInt(h.blockNumber)+1),e.abrupt("return",this.setState(function(e){return{prevTxs:i,loading:!1,lastBlockNumber:o,filters:Object(a.a)({},e.filters,{assets:c,actions:l})}},function(){f.processTxs()}));case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object.values(this.state.activeFilters).filter(function(e){return null!==e}).length>0,n=this.state.processedTxs?Object.values(this.state.processedTxs):null;return f.a.createElement(b.h,{flexDirection:"column",width:1,m:"0 auto"},this.state.loading?f.a.createElement(d.a,{flexProps:{flexDirection:"row",minHeight:this.props.height},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading transactions..."}):f.a.createElement(b.h,{width:1,position:"relative",flexDirection:"column",id:"transactions-list-container",pt:[0,t?"116px":5]},f.a.createElement(j,Object.assign({},this.props,{filters:this.state.filters,activeFilters:this.state.activeFilters,resetFilters:this.resetFilters.bind(this),applyFilters:this.applyFilters.bind(this)})),n&&n.length?f.a.createElement(b.h,{width:1,flexDirection:"column"},f.a.createElement(g.a,{cols:this.props.cols,isMobile:this.props.isMobile}),f.a.createElement(b.h,{id:"transactions-list",flexDirection:"column"},n.map(function(t,n){var a=t.hash,i=t.hashKey;return f.a.createElement(m.a,Object.assign({},e.props,{rowProps:{isInteractive:!0},hash:a,transaction:t,key:"tx-".concat(n),handleClick:function(e){return a?window.open("https://etherscan.io/tx/".concat(a)):null},rowId:"tx-col-".concat(i),cardId:"tx-card-".concat(i),fieldComponent:k.a}))})),f.a.createElement(b.h,{height:"50px",alignItems:"center",flexDirection:"row",justifyContent:"flex-end",id:"transactions-list-pagination"},f.a.createElement(b.h,{mr:3},f.a.createElement(b.n,{mr:1,onClick:function(t){return e.prevPage(t)}},f.a.createElement(b.k,{name:"KeyboardArrowLeft",size:"2em",color:this.state.page>1?"#4f4f4f":"#d8d8d8"})),f.a.createElement(b.n,{onClick:function(t){return e.nextPage(t)}},f.a.createElement(b.k,{name:"KeyboardArrowRight",size:"2em",color:this.state.page<this.state.totalPages?"#4f4f4f":"#d8d8d8"}))),f.a.createElement(b.h,{alignItems:"center"},f.a.createElement(b.u,{fontSize:1,fontWeight:3,color:"cellText"},"Page ",this.state.page," of ",this.state.totalPages)))):f.a.createElement(b.j.h3,{textAlign:"center",fontFamily:"sansSerif",fontWeight:2,fontSize:[2],color:"dark-gray"},"There are no transactions")))}}]),t}(h.Component);t.default=O},172:function(e,t,n){"use strict";n.r(t);var a=n(11),i=n(12),s=n(15),o=n(14),r=n(18),c=n(4),l=n(0),u=n.n(l),p=n(69),h=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=Object.assign({p:0,boxShadow:1,width:"40px",height:"40px",mainColor:"white",borderRadius:"50%",disabled:this.props.disabled},this.props.buttonProps);return e.minWidth=e.width,u.a.createElement(p.default,{buttonProps:e,handleClick:this.props.handleClick},u.a.createElement(c.k,{color:"copyColor",name:this.props.iconName,size:this.props.iconSize?this.props.iconSize:"1.3em"}))}}]),t}(l.Component);t.default=h},236:function(e,t,n){"use strict";n.r(t);var a=n(11),i=n(12),s=n(15),o=n(14),r=n(18),c=n(129),l=n(0),u=n.n(l),p=n(4),h=n(172),f=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=!!this.props.showPathMobile;return u.a.createElement(p.h,{width:1,id:"breadcrumb",alignItems:"center"},this.props.handleClick&&u.a.createElement(h.default,{buttonProps:{width:"35px",height:"35px"},iconSize:"1.2em",iconName:"ArrowBack",handleClick:this.props.handleClick}),this.props.text&&this.props.text.length>0&&u.a.createElement(p.n,{ml:[2,3],fontSize:[1,2],fontWeight:3,color:"cellText",hoverColor:"copyColor",onClick:this.props.handleClick},this.props.text),(!this.props.isMobile||t)&&this.props.path&&this.props.path.length>0&&this.props.path.map(function(t,n){var a=e.props.pathLink&&e.props.pathLink[n]||null,i=a?p.n:p.u;return u.a.createElement(i,{pl:[1,3],ml:[1,3],fontWeight:3,fontSize:[1,2],hoverColor:"copyColor",style:e.props.isMobile?null:{maxWidth:"30%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",borderLeft:"1px solid ".concat(c.a.colors.divider)},key:"breadcrumb_path_".concat(n),color:a?"cellText":"statValue",onClick:a?function(t){return e.props.goToSection(a)}:null},t)}))}}]),t}(l.Component);t.default=f},4734:function(e,t,n){"use strict";var a=n(11),i=n(12),s=n(15),o=n(14),r=n(18),c=n(0),l=n.n(c),u=n(4737),p=n.n(u),h=n(4),f=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=function(e){return l.a.createElement(h.j.h4,Object.assign({fontWeight:[3,4],color:"cellTitle",style:{width:"100%",whiteSpace:"nowrap"},fontSize:["10px",3],lineHeight:"initial"},e),e.children)};return l.a.createElement(h.h,{width:this.props.width},this.props.desc&&this.props.desc.length>1?l.a.createElement(h.h,{alignItems:"center"},l.a.createElement(t,this.props),l.a.createElement(h.n,{style:{cursor:"pointer"},onClick:function(t){return e.props.openTooltipModal(e.props.title,e.props.desc)}},l.a.createElement(h.y,{placement:"top",message:"Click to read the description"},l.a.createElement(h.k,{ml:1,name:"Info",color:"cellTitle",className:p.a.tooltip,size:this.props.isMobile?"1em":"1.2em"})))):l.a.createElement(t,this.props))}}]),t}(c.Component);t.a=f},4735:function(e,t,n){"use strict";var a=n(11),i=n(12),s=n(15),o=n(14),r=n(18),c=n(4),l=n(0),u=n.n(l),p=n(32),h=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldComponent,n="function"===typeof this.props.handleClick;return u.a.createElement(p.default,Object.assign({cardProps:{mb:2,width:1,px:[2,4],py:[2,"12px"]},id:this.props.cardId},this.props.rowProps,{className:this.props.token,isInteractive:n,handleClick:n?function(t){return e.props.handleClick(e.props)}:null}),u.a.createElement(c.h,{flexDirection:"row",id:this.props.rowId},this.props.cols.map(function(n,a){return!1===n.visible||!1===n.mobile&&e.props.isMobile?null:u.a.createElement(c.h,Object.assign({key:"col-".concat(a)},n.props),u.a.createElement(c.h,Object.assign({width:1,alignItems:"center",flexDirection:"row"},n.parentProps),n.fields.map(function(i,s){return!1===i.visible||!1===i.mobile&&e.props.isMobile?null:u.a.createElement(c.h,Object.assign({height:"100%",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},i.parentProps,{style:i.style?i.style:{overflow:"hidden"},width:n.fields.length>1?"auto":1,id:"field-".concat(a,"-").concat(s,"-").concat(i.name),key:"field-".concat(a,"-").concat(s,"-").concat(i.name)}),u.a.createElement(t,Object.assign({},e.props,{fieldInfo:i,colProps:n.props,parentId:"field-".concat(a,"-").concat(s,"-").concat(i.name)})))})))})))}}]),t}(l.Component);t.a=h},4736:function(e,t,n){"use strict";var a=n(11),i=n(12),s=n(15),o=n(14),r=n(18),c=n(4),l=n(0),u=n.n(l),p=n(4734),h=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement(c.h,{width:1,px:[2,4],pb:[2,3],flexDirection:"row"},this.props.cols.map(function(t,n){return!1===t.visible||!1===t.mobile&&e.props.isMobile?null:t.title&&t.title.length?u.a.createElement(p.a,Object.assign({},e.props,t.props,{desc:t.desc,title:t.title,key:"col-header-".concat(n)}),t.title):u.a.createElement(c.h,Object.assign({key:"col-header-".concat(n)},t.props))}))}}]),t}(l.Component);t.a=h},4737:function(e,t,n){e.exports={tooltip:"TableCellHeader_tooltip__3xM3k"}},4744:function(e,t,n){"use strict";var a=n(1),i=n.n(a),s=n(6),o=n(11),r=n(12),c=n(15),l=n(14),u=n(18),p=n(4),h=n(0),f=n.n(h),m=n(32),d=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(s.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return f.a.createElement(m.default,{key:this.props.point.id,cardProps:{py:2,px:3,width:1,left:this.props.point.data.itemPos&&this.props.point.data.itemPos>50?"-110%":"0"}},f.a.createElement(p.h,{width:1,flexDirection:"column"},this.props.point.data.xFormatted&&f.a.createElement(p.u,{mb:2,fontSize:1,fontWeight:3,color:"cellText",textAlign:"left"},this.props.point.data.xFormatted),this.props.children))}}]),t}(h.Component);t.a=d},4745:function(e,t,n){"use strict";var a=n(1),i=n.n(a),s=n(6),o=n(11),r=n(12),c=n(15),l=n(14),u=n(18),p=n(0),h=n.n(p),f=n(4),m=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(s.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement(f.h,{mb:2,width:1,alignItems:"center",flexDirection:"row"},h.a.createElement(f.h,{pr:2,style:{flexBasis:"0",flex:"1 1 0px"},alignItems:"center",justifyContent:"flex-start"},this.props.color&&h.a.createElement(f.b,{mr:2,width:"10px",height:"10px",borderRadius:"50%",backgroundColor:this.props.color}),h.a.createElement(f.u,{fontSize:1,fontWeight:2,textAlign:"left",color:"dark-gray",style:{textTransform:"capitalize"}},this.props.label)),h.a.createElement(f.h,{style:{flexBasis:"0",flex:"1 1 0px"},alignItems:"center",justifyContent:"flex-end"},h.a.createElement(f.u,{fontSize:1,fontWeight:3,color:"cellText",textAlign:"right",style:{whiteSpace:"nowrap"},dangerouslySetInnerHTML:{__html:this.props.value}})))}}]),t}(p.Component);t.a=m},4752:function(e,t,n){e.exports={radioBtn:"TransactionListFilters_radioBtn__1vgHa"}},4754:function(e,t,n){"use strict";var a=n(36),i=n(35),s=n(1),o=n.n(s),r=n(6),c=n(11),l=n(12),u=n(15),p=n(14),h=n(18),f=n(0),m=n.n(f),d=n(144),g=n(163),v=n(138),b=n(69),k=n(50),x=n(261),y=n(202),w=n(32),C=n(355),S=n(4),T=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,tokenConfig:null,unevenAmounts:null,selectedToken:null,availableTokens:null,buttonDisabled:!1,showMaxSlippage:!1,redeemUnderlying:!0,curveTokenConfig:null,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,curveTokensAmounts:null,fastBalanceSelector:null,redeemUnevenAmounts:!1,curveRedeemableIdleTokens:null},n.functionsUtil=null,n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t;t=!e||e.gt(n.state.curveTokenBalance),n.setState({buttonDisabled:t})},n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new k.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(r.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.initToken();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showMaxSlippage",value:function(){this.setState({showMaxSlippage:!0})}},{key:"calculateSlippage",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t,n,a,s,r,c,l,u,p,h,f=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:null,(n=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)&&!n.lte(0)){e.next=4;break}return e.abrupt("return",!1);case 4:if(a=this.functionsUtil.normalizeTokenAmount(n,this.state.curvePoolContract.decimals),s=null,r=null,c=null,!this.state.redeemUnevenAmounts){e.next=20;break}return e.next=11,Promise.all([this.functionsUtil.getCurveTokensAmounts(this.props.account,a,!0),this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,a)]);case 11:return l=e.sent,u=Object(i.a)(l,2),r=u[0],c=u[1],e.next=17,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1,c);case 17:s=e.sent,e.next=29;break;case 20:return e.next=22,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1);case 22:return s=e.sent,e.next=25,this.functionsUtil.getCurveTokenPrice();case 25:p=e.sent,h=n.times(p).minus(n.times(s.times(100).plus(this.state.maxSlippage||this.functionsUtil.BNify(0)).div(100))),(r={})[this.state.selectedToken]=h;case 29:return s&&(s=s.times(100)),this.setState({withdrawSlippage:s,curveTokensAmounts:r,curveIdleTokensAmounts:c}),s&&t&&(s=s.plus(t)),e.abrupt("return",s);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(r.a)(o.a.mark(function e(t,n){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),!(t.tokenConfig.idle.token!==this.props.tokenConfig.idle.token)){e.next=5;break}return e.next=5,this.initToken();case 5:a=n.redeemUnevenAmounts!==this.state.redeemUnevenAmounts,(this.state.fastBalanceSelector!==n.fastBalanceSelector||a)&&this.setInputValue(),i=n.inputValue!==this.state.inputValue,s=parseFloat(n.maxSlippage)!==parseFloat(this.state.maxSlippage),r=JSON.stringify(n.tokenConfig)!==JSON.stringify(this.state.tokenConfig),(i||r||s)&&this.calculateSlippage(),n.selectedToken!==this.state.selectedToken&&this.loadSelectedTokenConfig();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setInputValue",value:function(){if(null===this.state.fastBalanceSelector)return!1;var e,t=this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100);e=this.state.curveTokenBalance?this.functionsUtil.BNify(this.state.curveTokenBalance).times(t):null,this.checkButtonDisabled(e),this.setState({inputValue:e})}},{key:"selectDestinationToken",value:function(e){this.setState({selectedToken:e})}},{key:"loadSelectedTokenConfig",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.functionsUtil.getGlobalConfig(["curve"]),n=this.state.availableTokens[this.state.selectedToken],a=t.availableTokens[n.idle.token],this.setState({tokenConfig:n,curveTokenConfig:a});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t,n,a,s,r,c,l,u,p,h,f,m,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.functionsUtil.getCurvePoolContract(),this.functionsUtil.getCurveSwapContract()]);case 2:return t=e.sent,n=Object(i.a)(t,2),a=n[0],s=n[1],e.next=8,Promise.all([this.functionsUtil.getCurveTokenPrice(),this.functionsUtil.getCurveTokenBalance(this.props.account),this.functionsUtil.getCurveRedeemableIdleTokens(this.props.account)]);case 8:r=e.sent,c=Object(i.a)(r,3),l=c[0],u=c[1],p=c[2],h=[],f=u?u.times(l):this.functionsUtil.BNify(0),m=this.functionsUtil.getCurveAvailableTokens(),d=Object.keys(m)[0],this.setState({selectedToken:d,unevenAmounts:h,curveTokenPrice:l,availableTokens:m,curvePoolContract:a,curveSwapContract:s,curveTokenBalance:u,redeemableBalance:f,curveRedeemableIdleTokens:p});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redeem",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t,n,i,s,r,c,l,u,p,h,f,m=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.curveTokenBalance){e.next=2;break}return e.abrupt("return",!1);case 2:return t=function(e,t){var n="success"===e.status,a={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:m.props.selectedToken,eventValue:m.state.curveTokenBalance.toFixed()};t&&(a.eventLabel=m.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&m.functionsUtil.sendGoogleAnalyticsEvent(a),m.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof m.props.callbackRedeem&&n&&m.props.callbackRedeem(e)},n=function(e){var t=e.transactionHash;m.setState(function(e){return{processing:Object(a.a)({},e.processing,{txHash:t})}})},i=this.state.curveSwapContract.name,e.next=7,this.calculateSlippage(this.state.maxSlippage);case 7:if(s=e.sent,r=this.functionsUtil.BNify(this.state.maxSlippage).div(100),c=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null,l=this.functionsUtil.normalizeTokenAmount(c,this.state.curvePoolContract.decimals),!this.state.redeemUnevenAmounts){e.next=26;break}if(!this.state.redeemUnderlying){e.next=18;break}return e.next=15,this.functionsUtil.getCurveTokensAmounts(this.props.account,l,!1,!0);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,l,r);case 20:e.t0=e.sent;case 21:u=e.t0,console.log("remove_liquidity",l.toString(),u),this.props.contractMethodSendWrapper(i,"remove_liquidity",[l,u,this.state.redeemUnderlying],null,t,n),e.next=33;break;case 26:return p=this.state.curveTokenConfig.migrationParams.coinIndex,e.next=29,this.functionsUtil.getCurveTokenPrice();case 29:h=e.sent,f=this.functionsUtil.normalizeTokenAmount(c.times(h).minus(c.times(s.div(100))),this.state.tokenConfig.decimals),console.log("remove_liquidity_one_coin",l,p,f),this.props.contractMethodSendWrapper(i,"remove_liquidity_one_coin",[l,p,f,this.state.redeemUnderlying],null,t,n);case 33:this.setState(function(e){return{processing:Object(a.a)({},e.processing,{loading:!0})}});case 34:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var e=Object(r.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFastBalanceSelector",value:function(){return null!==this.state.fastBalanceSelector&&this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100)}},{key:"render",value:function(){var e=this,t=!this.state.buttonDisabled&&this.state.withdrawSlippage,n=this.functionsUtil.getGlobalConfig(["curve","poolContract","token"]);return m.a.createElement(S.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(S.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.state.curveTokenBalance?this.state.processing.loading?m.a.createElement(w.default,{cardProps:{p:3,mt:3}},m.a.createElement(S.h,{flexDirection:"column"},m.a.createElement(y.a,{web3:this.props.web3,hash:this.state.processing.txHash,endMessage:"Finalizing redeem request...",cancelTransaction:this.cancelTransaction.bind(this),waitText:this.props.waitText?this.props.waitText:"Redeem estimated in"}))):m.a.createElement(S.h,{width:1,flexDirection:"column"},m.a.createElement(w.default,{cardProps:{p:3,mb:2}},m.a.createElement(S.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(S.k,{size:"1.8em",color:"cellText",name:"FileUpload"}),m.a.createElement(S.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Withdraw from the Curve Pool in a specific token or in uneven amounts of tokens (with no slippage)."),m.a.createElement(S.h,{mt:2,alignItems:"center",flexDirection:"row"},m.a.createElement(S.e,{required:!1,label:"Redeem with no slippage",checked:this.state.redeemUnevenAmounts,onChange:function(t){return e.toggleUnevenAmounts(t.target.checked)}}),m.a.createElement(S.y,{placement:"top",message:"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool.")},m.a.createElement(S.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))),!this.state.redeemUnevenAmounts&&m.a.createElement(S.b,{mb:2,width:1},this.state.tokenConfig&&m.a.createElement(S.b,{width:1},m.a.createElement(S.u,{mb:1},"Select destination token:"),m.a.createElement(x.default,Object.assign({},this.props,{id:"token-from",showBalance:!1,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,onChange:this.selectDestinationToken.bind(this)})))),this.state.curveTokensAmounts&&!this.state.buttonDisabled&&m.a.createElement(w.default,{cardProps:{mt:1,mb:2,py:2,px:1}},m.a.createElement(S.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(S.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"You will receive:"),m.a.createElement(S.h,{mt:2,width:1,boxShadow:0,style:{flexWrap:"wrap"},alignItems:"center",justifyContent:"center"},Object.keys(this.state.curveTokensAmounts).map(function(t){var n=e.state.curveTokensAmounts[t];return m.a.createElement(S.h,{mb:1,mx:1,width:"auto",flexDirection:"row",key:"tokenBalance_".concat(t),justifyContent:"flex-start"},m.a.createElement(d.a,{token:t,tokenConfig:{token:t},fieldInfo:{name:"icon",props:{mr:1,width:["1.4em","1.6em"],height:["1.4em","1.6em"]}}}),m.a.createElement(v.a,{ml:1,fontSize:[0,1],fontWeight:500,maxPrecision:4,color:"cellText",number:n.toString()}))})))),this.state.showMaxSlippage&&t&&m.a.createElement(S.b,{mb:2,width:1},m.a.createElement(S.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(S.u,null,"Choose max slippage:"),m.a.createElement(S.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},m.a.createElement(S.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),m.a.createElement(S.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return m.a.createElement(C.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),m.a.createElement(S.h,{mb:3,width:1,flexDirection:"column"},m.a.createElement(S.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},t&&m.a.createElement(S.h,{width:1,maxWidth:"40%",alignItems:"center",flexDirection:"row"},m.a.createElement(S.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.withdrawSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.withdrawSlippage.toFixed(3))?"No Slippage":"".concat(this.state.withdrawSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.withdrawSlippage.abs().toFixed(3),"%")),m.a.createElement(S.y,{placement:"top",message:this.state.redeemUnevenAmounts?"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool."):this.state.withdrawSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},m.a.createElement(S.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),!this.state.redeemUnevenAmounts&&m.a.createElement(S.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage.bind(this)},"change")),m.a.createElement(S.h,{width:1,maxWidth:"60%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},m.a.createElement(S.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.state.curveTokenBalance.toFixed(this.props.isMobile?2:4)," ",n))),m.a.createElement(S.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),m.a.createElement(S.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return m.a.createElement(C.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})}))),m.a.createElement(S.h,{justifyContent:"center"},m.a.createElement(b.default,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.redeem.bind(this)},"Redeem"))):m.a.createElement(w.default,{cardProps:{p:3,mt:3,minHeight:"195px",style:{display:"flex",alignItems:"center",justifyContent:"center"}}},m.a.createElement(g.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking Curve Pool..."}))))}}]),t}(f.Component);t.a=T},4861:function(e,t,n){"use strict";n.r(t);var a=n(99),i=n(35),s=n(36),o=n(1),r=n.n(o),c=n(6),l=n(11),u=n(12),p=n(15),h=n(14),f=n(18),m=n(282),d=n(0),g=n.n(d),v=n(236),b=n(4),k=n(4754),x=n(50),y=n(591),w=n(69),C=n(202),S=n(32),T=n(355),j=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,depositSlippage:null,redeemableBalance:null,migrationContract:null,curveTokensBalance:null,migrationSucceeded:!1,fastBalanceSelector:null,migrationContractApproved:!1},n.functionsUtil=null,n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setInputValue=function(){if(null===n.state.fastBalanceSelector)return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100),t=n.props.idleTokenBalance?n.functionsUtil.BNify(n.props.idleTokenBalance).times(e):null;n.checkButtonDisabled(t),n.setState({inputValue:t})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector&&n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100)},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t=!e||e.gt(n.state.idleTokenBalance);n.setState({buttonDisabled:t})},n.approve=Object(c.a)(r.a.mark(function e(){var t,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.migrationContract)){e.next=6;break}return e.next=4,n.checkMigrationContractApproved();case 4:e.sent?n.setState({migrationContractApproved:!0}):(a=function(e,t){var a={eventAction:"approve",eventCategory:"CurveDeposit",eventLabel:e?e.status:null},i=e&&"success"===e.status;t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(e){return{migrationContractApproved:i,processing:Object(s.a)({},e.processing,{txHash:null,loading:!1})}}),"function"===typeof n.props.callbackApprove&&i&&n.props.callbackApprove(e),n.checkMigration()},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,{txHash:t})}})},n.functionsUtil.enableERC20(n.props.selectedToken,t.address,a,i),n.setState(function(e){return{processing:Object(s.a)({},e.processing,{txHash:null,loading:!0}),migrationContractApproved:!1}}));case 6:case"end":return e.stop()}},e,this)})),n.deposit=Object(c.a)(r.a.mark(function e(){var t,a,i,o,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.inputValue?n.functionsUtil.BNify(n.state.inputValue):null){e.next=3;break}return e.abrupt("return",!1);case 3:return a=function(e,a){var i="success"===e.status,s={eventLabel:e.status,eventCategory:"CurveDeposit",eventAction:n.props.selectedToken,eventValue:t.toFixed()};a&&(s.eventLabel=n.functionsUtil.getTransactionError(a)),(a||"error"!==s.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(s),n.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof n.props.callbackDeposit&&i&&n.props.callbackDeposit(e)},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,{txHash:t})}})},o=n.state.migrationContract.name,c=n.functionsUtil.normalizeTokenAmount(t,n.props.tokenConfig.decimals),e.next=9,n.getMigrationParams(c);case 9:l=e.sent,n.props.contractMethodSendWrapper(o,"add_liquidity",l,null,a,i),n.setState(function(e){return{processing:Object(s.a)({},e.processing,{loading:!0})}});case 12:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.approveCallback=function(){n.initToken()},n.migrationCallback=function(){n.setState({migrationSucceeded:!0})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new x.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initToken();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t,n){var a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.idleTokenBalance!==this.props.idleTokenBalance,!a&&!i){e.next=6;break}return e.next=6,this.initToken();case 6:this.state.fastBalanceSelector!==n.fastBalanceSelector&&this.setInputValue(),this.state.inputValue!==n.inputValue&&this.calculateSlippage();case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMigrationParams",value:function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],a=this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.selectedToken])){e.next=4;break}return e.abrupt("return",!1);case 4:if(!a.migrationParams.n_coins){e.next=15;break}return e.next=8,this.functionsUtil.getCurveAmounts(this.props.selectedToken,t,!0);case 8:return i=e.sent,e.next=11,this.functionsUtil.getCurveTokenAmount(i);case 11:s=e.sent,this.state.maxSlippage&&(s=(s=this.functionsUtil.BNify(s)).minus(s.times(this.functionsUtil.BNify(this.state.maxSlippage).div(100))),s=this.functionsUtil.integerValue(s)),n.push(i),n.push(s);case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n,a,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)){e.next=17;break}if(!(n=t)){e.next=10;break}return e.next=6,this.functionsUtil.getIdleTokenPrice(this.props.tokenConfig);case 6:(a=e.sent)&&(n=n.times(a)),e.next=11;break;case 10:n=this.functionsUtil.BNify(0);case 11:return i=this.functionsUtil.normalizeTokenAmount(n,this.props.tokenConfig.decimals),e.next=14,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,i);case 14:(s=e.sent)&&(s=s.times(100)),this.setState({depositSlippage:s});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkMigrationContractApproved",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.migrationContract,e.t0){e.next=5;break}return e.next=4,this.functionsUtil.getCurveSwapContract();case 4:e.t0=e.sent;case 5:if(!(t=e.t0)){e.next=10;break}return e.next=9,this.functionsUtil.checkTokenApproved(this.props.tokenConfig.idle.token,t.address,this.props.account);case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveSwapContract();case 2:return t=e.sent,e.next=5,this.checkMigrationContractApproved();case 5:n=e.sent,this.setState({migrationContract:t,migrationContractApproved:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken)return null;var t=this.state.curveTokensBalance&&this.state.curveTokensBalance.gt(0);return g.a.createElement(b.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},g.a.createElement(b.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.props.idleTokenBalance&&this.props.idleTokenBalance.gt(0)&&g.a.createElement(b.b,{width:1},g.a.createElement(S.default,{cardProps:{p:3,px:[2,4]}},g.a.createElement(b.h,{alignItems:"center",flexDirection:"column"},g.a.createElement(b.h,{width:1,alignItems:"center",flexDirection:"row"},g.a.createElement(b.k,{size:"1.5em",name:this.state.migrationContractApproved?"CheckBox":"LooksOne",color:this.state.migrationContractApproved?this.props.theme.colors.transactions.status.completed:"cellText"}),g.a.createElement(b.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Approve the Curve contract")),g.a.createElement(b.h,{mt:2,width:1,alignItems:"center",flexDirection:"row"},g.a.createElement(b.k,{size:"1.5em",name:t?"CheckBox":"LooksTwo",color:t?this.props.theme.colors.transactions.status.completed:"cellText"}),g.a.createElement(b.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Deposit your ",this.props.tokenConfig.idle.token)))),this.state.migrationContractApproved?this.state.processing.loading?g.a.createElement(b.h,{mt:3,flexDirection:"column"},g.a.createElement(C.a,{web3:this.props.web3,waitText:"Deposit estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing deposit request...",cancelTransaction:this.cancelTransaction.bind(this)})):g.a.createElement(b.b,{mt:2,width:1},g.a.createElement(b.h,{alignItems:"center",flexDirection:"row"},g.a.createElement(b.u,null,"Choose max slippage:"),g.a.createElement(b.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},g.a.createElement(b.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),g.a.createElement(b.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return g.a.createElement(T.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})})),g.a.createElement(b.h,{mt:2,mb:3,width:1,flexDirection:"column"},g.a.createElement(b.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:this.state.depositSlippage?"space-between":"flex-end"},this.state.depositSlippage&&g.a.createElement(b.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},g.a.createElement(b.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.depositSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositSlippage.toFixed(3))?"No Slippage":"".concat(this.state.depositSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositSlippage.abs().toFixed(3),"%")),g.a.createElement(b.y,{placement:"top",message:this.state.depositSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},g.a.createElement(b.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),this.props.idleTokenBalance&&g.a.createElement(b.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},g.a.createElement(b.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.props.idleTokenBalance.toFixed(this.props.isMobile?2:4)," ",this.props.selectedToken))),g.a.createElement(b.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),g.a.createElement(b.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return g.a.createElement(T.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})})),g.a.createElement(b.h,{mt:2,justifyContent:"center"},g.a.createElement(w.default,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.deposit.bind(this)},"Deposit")))):this.state.processing.loading?g.a.createElement(b.h,{mt:3,flexDirection:"column"},g.a.createElement(C.a,{web3:this.props.web3,waitText:"Approve estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing approve request...",cancelTransaction:this.cancelTransaction.bind(this)})):g.a.createElement(S.default,{cardProps:{p:3,mt:3}},g.a.createElement(b.h,{alignItems:"center",flexDirection:"column"},g.a.createElement(b.k,{size:"2.3em",name:"LockOpen",color:"cellText"}),g.a.createElement(b.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"To deposit your ",this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."),g.a.createElement(w.default,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approve.bind(this)},"Approve"))))))}}]),t}(d.Component),O=n(261),E=n(301),U=n(1114),B=n(129),D=n(144),A=n(779),P=n(500),I=n(4744),F=n(4745),M=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={startDate:null,chartData:null,chartProps:null,chartwidth:null,chartHeight:null},n.functionsUtil=null,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new x.a(this.props)}},{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadChartData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t,n){var a,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.quickDateSelection!==this.props.quickDateSelection,(JSON.stringify(t.enabledTokens)!==JSON.stringify(this.props.enabledTokens)||a)&&this.setState({chartData:null},function(){i.componentDidMount()}),t.isMobile!==this.props.isMobile&&this.loadChartData();case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadChartData",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n,a,i,s,o,c,l,u,p,h,f,m,d,v,b,k,x,y,w,C,S,T,j,O,E,U,D,A,P,M,N,z=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.props.enabledTokens)&&t.length||(t=Object.keys(this.props.availableTokens)),e.next=4,this.functionsUtil.getCurveTxs(this.props.account,0,"latest",t);case 4:n=e.sent,a=[],i=[],s={},o=null,c=this.functionsUtil.BNify(0),l=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),n&&n.length&&n.forEach(function(e,t){if(s[e.hash]||(s[e.hash]=[]),!s[e.hash].includes(e.action)){o=o?Math.min(o,parseInt(e.timeStamp)):parseInt(e.timeStamp);var n=z.functionsUtil.BNify(e.curveTokens);switch(e.action){case"CurveIn":case"CurveZapIn":case"CurveDepositIn":case"CurveTransferIn":c=c.plus(n);break;case"CurveOut":case"CurveZapOut":case"CurveDepositOut":case"CurveTransferOut":c=c.minus(n)}c.lt(0)&&(c=z.functionsUtil.BNify(0));var a=e.action,r=c,u=parseInt(e.timeStamp),p=z.functionsUtil.fixTokenDecimals(e.curveTokenPrice,l.decimals);p.isNaN()||p.isNaN()||(i.push({action:a,balance:r,timeStamp:u,curveTokens:n,curveTokenPrice:p}),s[e.hash].push(a))}}),u=null,p=this.functionsUtil.strToMoment(new Date),e.t0=this.props.quickDateSelection,e.next="week"===e.t0?17:"month"===e.t0?19:"month3"===e.t0?21:"month6"===e.t0?23:25;break;case 17:return u=p.clone().subtract(1,"week"),e.abrupt("break",27);case 19:return u=p.clone().subtract(1,"month"),e.abrupt("break",27);case 21:return u=p.clone().subtract(3,"month"),e.abrupt("break",27);case 23:return u=p.clone().subtract(6,"month"),e.abrupt("break",27);case 25:return u=null,e.abrupt("break",27);case 27:return h={},f={},m=null,d=null,v=null,b={},k={},x=this.functionsUtil.BNify(0),y=parseInt((new Date).getTime()/1e3)+86400,e.next=38,this.functionsUtil.getTokenApiData(Object.values(this.props.availableTokens)[0].address,!1,o,null,!1,3600);case 38:w=e.sent,C=r.a.mark(function e(t){var n,a,s,c,p,g,C,T,j,O,E,U,B;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},a={},t=Math.min(y,t),s=z.functionsUtil.strToMoment(1e3*t),c=w.filter(function(e){return e.timestamp>=m&&e.timestamp<=t}),(p=i.filter(function(e){return e.timeStamp<=t&&(!m||e.timeStamp>m)})).length){e.next=21;break}if(!f){e.next=20;break}if(p=f,g=Object.values(p).pop(),C=parseFloat(g.balance),T=Object.values(c).pop(),j=null,!T){e.next=17;break}return e.next=16,z.functionsUtil.getCurveTokenPrice(T.blocknumber);case 16:j=e.sent;case 17:C>0&&t>o&&j&&(g.curveTokenPrice=j,p=[g]),e.next=21;break;case 20:p=[{balance:z.functionsUtil.BNify(0),curveTokenPrice:z.functionsUtil.BNify(0)}];case 21:O=Object.assign([],p).pop(),E=z.functionsUtil.BNify(O.balance).times(O.curveTokenPrice),a[l.token]=z.functionsUtil.BNify(O.balance),x=E,n=p,(null===u||s.isSameOrAfter(u))&&(s.isAfter(new Date,"day")&&(s=z.functionsUtil.strToMoment(new Date)),U=s.format("YYYY/MM/DD 00:00"),h[s.format("YYYY/MM/DD")]=1,B=parseFloat(parseFloat(x.toFixed(6))),b[U]=B,k[U]=a,d=null===d?B:Math.min(d,B),v=null===v?B:Math.max(v,B)),m=t,f=n,S=t;case 30:case"end":return e.stop()}},e,this)}),S=o;case 41:if(!(S<=y)){e.next=46;break}return e.delegateYield(C(S),"t1",43);case 43:S+=this.props.frequencySeconds,e.next=41;break;case 46:for(T=Object.keys(b).map(function(e){return{x:e,y:b[e],balances:k[e]}}),j=0,T.forEach(function(e,t){var n=Math.floor(j/T.length*100);T[t].itemPos=n,j++}),a.push({id:"USD",color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens","USD","color","hsl"]).join(",")+")",data:T}),O=2,v-d<1&&(O=4),v===d&&(d=Math.max(0,v-1)),5,E=(v-d)/5,U=[],D=0;D<=5;D++)A=parseFloat(parseFloat(d+D*E).toFixed(6)),U.push(A);10,P=Object.values(h).length,M=Math.max(1,Math.ceil(P/10)),N={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},yScale:{type:"linear",stacked:!1,min:d,max:v},xFormat:"time:%b %d %Y",yFormat:function(e){return z.functionsUtil.formatMoney(e,O)},axisBottom:this.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:15,orient:"bottom",legendOffset:36,legendPosition:"middle",tickValues:"every "+M+" days"},gridYValues:U,pointSize:0,useMesh:!0,axisLeft:this.props.isMobile?null:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return z.functionsUtil.abbreviateNumber(e,2)}},animate:!0,pointLabel:"y",areaOpacity:.1,enableArea:!0,enableSlices:"x",enableGridY:!0,curve:"monotoneX",enableGridX:!1,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,areaBaselineValue:d,pointColor:{from:"color",modifiers:[]},theme:{axis:{ticks:{text:{fontSize:12,fontWeight:600,fill:B.a.colors.legend,fontFamily:B.a.fonts.sansSerif}}},grid:{line:{stroke:"#dbdbdb",strokeDasharray:"8 4"}}},margin:this.props.isMobile?{top:20,right:25,bottom:25,left:20}:{top:30,right:50,bottom:45,left:50},sliceTooltip:function(e){var t=e.slice.points[0];return g.a.createElement(I.a,{point:t},g.a.createElement(F.a,{color:t.color,label:t.serieId,value:"$ ".concat(t.data.yFormatted)}),"object"===typeof t.data.balances&&Object.keys(t.data.balances).length>0&&Object.keys(t.data.balances).map(function(e){if(e===t.serieId)return null;var n=z.functionsUtil.getGlobalConfig(["stats","tokens",e]);if(n){var a=n.name?n.name:e,i=n.color.hex,s=t.data.balances[e],o=z.functionsUtil.formatMoney(s,2);if(parseFloat(s)>=.01)return g.a.createElement(F.a,{label:a,color:i,key:"row_".concat(e),value:"".concat(o)})}return null}))}},this.setState({chartData:a,chartProps:N});case 62:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return g.a.createElement(P.a,Object.assign({type:A.a,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:this.props.parentId,height:this.props.chartHeight,parentIdHeight:this.props.parentIdHeight}))}}]),t}(d.Component),N=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={compAPR:null,aggregatedValues:[],govTokensUserBalance:null},n.functionsUtil=null,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new x.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveAvgBuyPrice();case 2:return e.next=4,this.functionsUtil.getCurveAvgSlippage();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return g.a.createElement(b.h,{width:1,flexDirection:"column"},this.state.aggregatedValues.length>0&&g.a.createElement(b.h,{width:1,mb:[0,3],mt:[2,0],alignItems:"center",flexDirection:["column","row"],justifyContent:"space-between"},this.state.aggregatedValues.map(function(e,t){return g.a.createElement(b.h,Object.assign({},e.flexProps,{flexDirection:"column",key:"aggregatedValue_".concat(t)}),g.a.createElement(S.default,{cardProps:{py:[2,3],mb:[3,0]}},g.a.createElement(b.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.props.children?e.props.children:g.a.createElement(b.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:[4,"1.7em"],dangerouslySetInnerHTML:{__html:e.props.value}}),g.a.createElement(b.u,{mt:2,fontWeight:2,fontSize:[1,2],color:"cellText"},e.props.title))))})),g.a.createElement(S.default,{cardProps:{px:2,py:3}},g.a.createElement(b.h,{width:1,ml:[0,3],id:"funds-overview"},g.a.createElement(M,Object.assign({},this.props,{chartHeight:350,parentId:"funds-overview",frequencySeconds:this.functionsUtil.getFrequencySeconds("day",1)}))),g.a.createElement(b.h,{width:1,flexDirection:["column","row"]},g.a.createElement(b.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},g.a.createElement(m.a,{mb:2,fontSize:[3,4],component:b.j.h3},"Deposited"),g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"amountLentCurve",props:{decimals:4,maxPrecision:8,fontWeight:300,fontSize:["1.8em","1.9em"],color:B.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),g.a.createElement(b.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},g.a.createElement(m.a,{mb:2,fontSize:[3,4],component:b.j.h3},"Redeemable"),g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"redeemableBalanceCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,color:B.a.colors.counter,fontSize:this.props.isMobile?"1.8em":"1.9em"},flexProps:{justifyContent:"center"}}}})),g.a.createElement(b.h,{width:1,mt:"-9px"},g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsPercCurve",props:{fontSize:1,fontWeight:2,color:"cellText",flexProps:{justifyContent:"center"}}}})))),g.a.createElement(b.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},g.a.createElement(m.a,{mb:2,fontSize:[3,4],component:b.j.h3},"Earnings"),g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:B.a.colors.counter},flexProps:{justifyContent:"center"}}}}))),g.a.createElement(b.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},g.a.createElement(m.a,{mb:2,fontSize:[3,4],component:b.j.h3},"Current APY"),g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveApy",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:B.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),g.a.createElement(b.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},g.a.createElement(m.a,{mb:2,fontSize:[3,4],component:b.j.h3},"Avg Slippage"),g.a.createElement(D.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveAvgSlippage",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:B.a.colors.counter,flexProps:{justifyContent:"center"}}}}))))))}}]),t}(d.Component),z=function(e){function t(){var e,n;Object(l.a)(this,t);for(var o=arguments.length,u=new Array(o),f=0;f<o;f++)u[f]=arguments[f];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(u)))).state={inputValue:{},processing:{},tokenFees:null,canRedeem:null,canDeposit:null,action:"deposit",activeModal:null,tokenConfig:null,tokenBalance:null,tokenApproved:null,selectedToken:null,availableTokens:{},redeemBalance:null,depositBalance:null,buttonDisabled:!1,curveTokenPrice:null,depositSlippage:null,idleTokenBalance:null,withdrawSlippage:null,govTokensBalance:null,curveZapContract:null,curveTokenConfig:null,curveTokensAmounts:{},govTokensDisabled:null,componentMounted:!1,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,redeemableBalance:null,fastBalanceSelector:{},curveAvailableTokens:{},tokenFeesPercentage:null,redeemUnevenAmounts:!1,curveDepositContract:null},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.changeFromToken=function(e){var t=n.functionsUtil.getGlobalConfig(["curve"]);n.props.goToSection("".concat(t.params.route,"/").concat(e))},n.setSelectedToken=function(){var e=Object(c.a)(r.a.mark(function e(t){var a,i,s,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.functionsUtil.getCurveAvailableTokens(),i=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),s=i[t],o=a[s.baseToken],n.setState({tokenConfig:o,selectedToken:t,availableTokens:a,curveTokenConfig:s});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadTokensInfo=Object(c.a)(r.a.mark(function e(){var t,a,o,c,l,u,p,h,f,m,d,g,v,b;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),n.setState({curveAvailableTokens:t}),!(a=n.getSelectedToken())||a===n.props.urlParams.param1){e.next=10;break}return n.changeFromToken(a),e.next=7,n.setSelectedToken(a);case 7:return e.abrupt("return",e.sent);case 10:if(a===n.state.selectedToken){e.next=13;break}return e.next=13,n.setSelectedToken(a);case 13:return o=Object(s.a)({},n.state),c=n.functionsUtil.getCurveAvailableTokens(),o.selectedToken!==a&&(o.selectedToken=a),l=t[a],u=c[l.baseToken],e.next=20,Promise.all([n.functionsUtil.getCurveZapContract(),n.functionsUtil.getCurvePoolContract(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract()]);case 20:if(p=e.sent,h=Object(i.a)(p,4),f=h[0],m=h[1],d=h[2],g=h[3],o.curveZapContract=f,o.curvePoolContract=m,o.curveSwapContract=d,o.curveDepositContract=g,o.availableTokens=c,{}[a]=u,o.tokenConfig=u,o.curveTokenConfig=l,!n.props.account){e.next=57;break}return e.next=38,Promise.all([n.functionsUtil.getCurveTokenPrice(),n.functionsUtil.getCurveTokenBalance(),n.functionsUtil.getTokenFees(u),n.functionsUtil.getUserTokenFees(u,n.props.account),n.functionsUtil.getTokenBalance(a,n.props.account),n.functionsUtil.getTokenBalance(u.idle.token,n.props.account),n.functionsUtil.checkTokenApproved(a,g.address,n.props.account)]);case 38:v=e.sent,b=Object(i.a)(v,7),o.curveTokenPrice=b[0],o.curveTokenBalance=b[1],o.tokenFeesPercentage=b[2],o.tokenFees=b[3],o.tokenBalance=b[4],o.idleTokenBalance=b[5],o.tokenApproved=b[6],o.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1}},o.inputValue={redeem:null,deposit:null},o.fastBalanceSelector={redeem:null,deposit:null},o.componentMounted=!0,o.depositBalance=o.tokenBalance,o.redeemBalance=o.redeemableBalance,o.govTokensDisabled=u.govTokensDisabled,o.canRedeem=o.curveTokenBalance&&o.curveTokenBalance.gt(0),o.canDeposit=o.idleTokenBalance&&o.idleTokenBalance.gt(0),o.redeemableBalance=o.curveTokenBalance?o.curveTokenBalance.times(o.curveTokenPrice):n.functionsUtil.BNify(0);case 57:n.setState(o);case 58:case"end":return e.stop()}},e,this)})),n.updateAssetSelector=Object(c.a)(r.a.mark(function e(){var t,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=n.state.action,e.next="deposit"===e.t0?4:"redeem"===e.t0?6:12;break;case 4:return n.loadTokensInfo(),e.abrupt("break",13);case 6:return a=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),t.curveAvailableTokens={},t.curveTokenConfig=a,t.selectedToken=a.token,t.curveAvailableTokens[a.token]=a,e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:n.setState(t);case 14:case"end":return e.stop()}},e,this)})),n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(s.a)({},t.fastBalanceSelector,Object(a.a)({},n.state.action,e))}})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.state.tokenBalance?n.functionsUtil.BNify(n.state.tokenBalance).times(e):null;break;case"redeem":t=n.state.redeemUnevenAmounts?n.state.curveTokenBalance?n.functionsUtil.BNify(n.state.curveTokenBalance).times(e):null:n.state.redeemableBalance?n.functionsUtil.BNify(n.state.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(s.a)({},e.inputValue,Object(a.a)({},n.state.action,t))}})},n.changeInputValue=function(e){if(!n.state.action)return!1;var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t),n.setState(function(e){return{fastBalanceSelector:Object(s.a)({},e.fastBalanceSelector,Object(a.a)({},n.state.action,null)),inputValue:Object(s.a)({},e.inputValue,Object(a.a)({},n.state.action,t))}})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&e.gt(n.state.tokenBalance);break;case"redeem":t=n.state.redeemUnevenAmounts?!n.state.canRedeem||t||e&&e.gt(n.state.curveTokenBalance):!n.state.canRedeem||t||e&&e.gt(n.state.redeemableBalance)}n.setState({buttonDisabled:t})},n.cancelTransaction=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.approveToken=Object(c.a)(r.a.mark(function e(){var t,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.tokenApproved)){e.next=3;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(s.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 3:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.state.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(s.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,{approve:Object(s.a)({},e.processing.approve,{txHash:t})})}})},n.functionsUtil.enableERC20(n.state.selectedToken,n.state.curveDepositContract.address,a,i),n.setState(function(e){return{processing:Object(s.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 7:case"end":return e.stop()}},e,this)})),n.executeAction=Object(c.a)(r.a.mark(function e(){var t,i,o,c,l,u,p,h,f,m,d,g,v,b,k,x,y;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,i=n.state.inputValue[n.state.action],o=n.getFastBalanceSelector(),c=!0,e.t0=n.state.action,e.next="deposit"===e.t0?7:"redeem"===e.t0?23:56;break;case 7:if(!n.state.buttonDisabled&&i&&!n.functionsUtil.BNify(i).lte(0)){e.next=9;break}return e.abrupt("return",!1);case 9:return l=n.functionsUtil.normalizeTokenAmount(i,n.state.curvePoolContract.decimals),u=function(e,t){!e&&t&&(e={status:"error"});var o="error"===e.status,r="success"===e.status,c={eventCategory:"Deposit",eventAction:n.state.selectedToken,eventLabel:e.status,eventValue:parseInt(i)};t&&(c.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==c.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(c),n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({},n.state.action,{txHash:null,loading:!1}))}}),r?n.setState(function(e){return{activeModal:"share",inputValue:Object(s.a)({},e.inputValue,Object(a.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):n.state.metaTransactionsEnabled&&o&&n.setState({txError:Object(a.a)({},n.state.action,!0)})},p=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=14,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,l);case 14:return h=e.sent,e.next=17,n.functionsUtil.genericContractCall(n.state.curveSwapContract.name,"calc_token_amount",[h,!0]);case 17:return f=e.sent,m=[h,f],e.next=21,n.props.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",m,null,u,p);case 21:return t=e.sent,e.abrupt("break",58);case 23:if(!n.state.buttonDisabled&&i&&!n.functionsUtil.BNify(i).lte(0)){e.next=25;break}return e.abrupt("return",!1);case 25:if(d=null,!o){e.next=30;break}d=n.functionsUtil.BNify(n.state.curveTokenBalance).times(o),e.next=36;break;case 30:if(d=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(i,n.state.curvePoolContract.decimals)),n.state.redeemUnevenAmounts){e.next=36;break}return e.next=34,n.functionsUtil.getCurveTokenPrice();case 34:g=e.sent,d=d.div(g);case 36:if(d){e.next=38;break}return e.abrupt("return",!1);case 38:return v=function(e,t){var i="success"===e.status,o={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:n.state.selectedToken,eventValue:d.toFixed()};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({},n.state.action,{txHash:null,loading:!1}))}}),i&&n.setState(function(e){return{inputValue:Object(s.a)({},e.inputValue,Object(a.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},b=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{txHash:t})))}})},k=n.functionsUtil.normalizeTokenAmount(d,n.state.curvePoolContract.decimals).toString(),e.next=43,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,0);case 43:if(x=e.sent,y=n.state.curveDepositContract.name,!n.state.redeemUnevenAmounts){e.next=50;break}console.log("remove_liquidity_imbalance",n.functionsUtil.BNify(i).toString(),k.toString(),x),n.props.contractMethodSendWrapper(y,"remove_liquidity_imbalance",[x,k],null,v,b),e.next=55;break;case 50:return e.next=52,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,k);case 52:x=e.sent,console.log("remove_liquidity",n.functionsUtil.BNify(i).toString(),k.toString(),x),n.props.contractMethodSendWrapper(y,"remove_liquidity",[k,x],null,v,b);case 55:return e.abrupt("break",58);case 56:return c=!1,e.abrupt("break",58);case 58:!1!==t&&n.setState(function(e){return{processing:Object(s.a)({},e.processing,Object(a.a)({},n.state.action,Object(s.a)({},e.processing[n.state.action],{loading:c})))}});case 59:case"end":return e.stop()}},e,this)})),n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new x.a(this.props)}},{key:"getSelectedToken",value:function(){var e=this.functionsUtil.getGlobalConfig(["curve","availableTokens"]);return this.props.urlParams.param1&&e[this.props.urlParams.param1]?this.props.urlParams.param1:Object.keys(e)[0]}},{key:"componentWillMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.normalizeTokenAmount(t,this.state.curvePoolContract.decimals),a={},e.t0=this.state.action,e.next="deposit"===e.t0?8:"redeem"===e.t0?13:18;break;case 8:return a.depositBalance=t,e.next=11,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 11:return a.depositSlippage=e.sent,e.abrupt("break",19);case 13:return a.redeemBalance=t,e.next=16,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 16:return a.withdrawSlippage=e.sent,e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:this.setState(a);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t,n){var a,i,s,o,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.urlParams.param1!==this.props.urlParams.param1,s=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,!(a||s||i)){e.next=7;break}return e.next=7,this.loadTokensInfo();case 7:o=this.state.action!==n.action,c=this.state.redeemUnevenAmounts!==n.redeemUnevenAmounts,l=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(o||l||c)&&this.setInputValue(),o&&this.updateAssetSelector(),n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateSlippage();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.account&&this.state.curveTokenBalance&&this.functionsUtil.BNify(this.state.curveTokenBalance).gt(0);return g.a.createElement(b.b,{width:1},g.a.createElement(b.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},g.a.createElement(b.h,{width:.5},g.a.createElement(v.default,{isMobile:this.props.isMobile,path:["Boost",this.state.selectedToken],handleClick:function(t){return e.props.goToSection("best")},text:this.functionsUtil.getGlobalConfig(["strategies","best","title"])}))),g.a.createElement(m.a,{mb:[3,4]},"Curve Pool"),g.a.createElement(b.h,{width:1},g.a.createElement(b.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},g.a.createElement(b.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},g.a.createElement(b.b,{width:1},g.a.createElement(b.u,{mb:1},"Select your asset:"),g.a.createElement(O.default,Object.assign({},this.props,{id:"token-from",onChange:this.changeFromToken,selectedToken:this.state.selectedToken,tokenConfig:this.state.curveTokenConfig,showBalance:"deposit"===this.state.action,availableTokens:this.state.curveAvailableTokens}))),g.a.createElement(b.b,{width:1},g.a.createElement(b.h,{mt:2,flexDirection:"column"},g.a.createElement(b.u,{mb:2},"Choose the action:"),g.a.createElement(b.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},g.a.createElement(S.default,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},g.a.createElement(b.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},g.a.createElement(E.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),g.a.createElement(b.u,{fontSize:3,fontWeight:3},"Deposit"))),g.a.createElement(S.default,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isDisabled:!this.state.canRedeem,isActive:"redeem"===this.state.action},g.a.createElement(b.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},g.a.createElement(E.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),g.a.createElement(b.u,{fontSize:3,fontWeight:3},"Redeem"))))))),g.a.createElement(b.h,{width:1,mt:this.props.account?3:0},"deposit"===this.state.action?g.a.createElement(j,Object.assign({},this.props,this.state)):"redeem"===this.state.action&&g.a.createElement(k.a,Object.assign({},this.props,this.state))))),t&&g.a.createElement(b.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},g.a.createElement(m.a,{my:[3,4]},"Funds Overview"),g.a.createElement(N,Object.assign({},this.props,{tokenFees:this.state.tokenFees,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens)}))),this.props.account&&g.a.createElement(b.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},g.a.createElement(m.a,{my:[3,4]},"Transactions"),g.a.createElement(U.default,Object.assign({},this.props,{availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens),enabledActions:["CurveIn","CurveOut","CurveZapIn","CurveZapOut","CurveTransferIn","CurveTransferOut","CurveDepositIn","CurveDepositOut"],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]}))),g.a.createElement(y.default,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.state.selectedToken,isOpen:"buy"===this.state.activeModal})))}}]),t}(d.Component);t.default=z}}]);
//# sourceMappingURL=20.8217661c.chunk.js.map