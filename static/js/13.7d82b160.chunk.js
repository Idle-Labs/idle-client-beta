(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{4948:function(t,e,n){"use strict";n.r(e);var o=n(1),i=n.n(o),s=n(6),a=n(11),l=n(12),r=n(15),c=n(14),u=n(18),f=n(1906),h=n(0),p=n.n(h),d=n(4),m=n(144),k=n(138),b=n(50),g=n(500),v=function(t){function e(){var t,n;Object(a.a)(this,e);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(n=Object(r.a)(this,(t=Object(c.a)(e)).call.apply(t,[this].concat(i)))).state={chartData:null,totalFunds:null,chartProps:null,parentWidth:null,selectedToken:null,selectedTokenConfig:null},n.functionsUtil=null,n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new b.a(this.props)}},{key:"componentWillMount",value:function(){this.loadUtils()}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){var t=Object(s.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadPortfolio();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(i.a.mark(function t(e,n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),JSON.stringify(Object.keys(e.availableTokens))!==JSON.stringify(Object.keys(this.props.availableTokens))&&this.loadPortfolio();case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadPortfolio",value:function(){var t=Object(s.a)(i.a.mark(function t(){var e,n,o,a,l,r,c=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},n=this.functionsUtil.BNify(0),o="risk"===this.props.selectedStrategy,t.next=5,this.functionsUtil.asyncForEach(Object.keys(this.props.availableTokens),function(){var t=Object(s.a)(i.a.mark(function t(s){var a,l,r,u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.props.availableTokens[s],t.next=3,c.functionsUtil.getTokenBalance(a.idle.token,c.props.account);case 3:if(!(l=t.sent)){t.next=12;break}return t.next=7,c.functionsUtil.getIdleTokenPrice(a);case 7:return r=t.sent,t.next=10,c.functionsUtil.convertTokenBalance(l.times(r),s,a,o);case 10:(u=t.sent).gt(0)&&(e[s]=u,n=n.plus(u));case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}());case 5:return t.next=7,this.functionsUtil.getGovTokensUserBalances(this.props.account,this.props.availableTokens,"DAI",null,!0);case 7:(a=t.sent)&&Object.keys(a).forEach(function(t){var o=c.functionsUtil.BNify(a[t]);e[t]=o,n=n.plus(o)}),l=[],Object.keys(e).forEach(function(t){var o=e[t];if(o.gt(0)){var i=o.div(n).times(100),s=c.functionsUtil.getGlobalConfig(["stats","tokens",t.toUpperCase(),"color","hsl"]);s=s?s.join(","):"0,0%,0%",l.push({id:t,label:t.substr(0,1).toUpperCase()+t.substr(1),value:Math.round(i),color:"hsl("+s+")"})}}),r={padAngle:0,animate:!0,borderWidth:0,cornerRadius:0,innerRadius:.65,motionDamping:15,motionStiffness:90,colors:function(t){return t.color},tooltipFormat:function(t){return t+"%"},sliceLabel:function(t){return parseFloat(t.value)>=5?t.value+"%":null},radialLabel:function(t){return null},theme:{tooltip:{container:{display:"none"}},labels:{text:{fontSize:16,fontWeight:500,fontFamily:this.props.theme.fonts.sansSerif}},legends:{text:{fontSize:13,fontWeight:500,fontFamily:this.props.theme.fonts.sansSerif}}},slicesLabelsSkipAngle:5,slicesLabelsTextColor:"#fff",radialLabelsLinkStrokeWidth:0,radialLabelsTextColor:"#333",radialLabelsSkipAngle:10,radialLabelsTextXOffset:0,radialLabelsLinkOffset:-parseInt(.2*this.state.parentWidth),radialLabelsLinkDiagonalLength:0,radialLabelsLinkHorizontalLength:0,radialLabelsLinkColor:{from:"color"},margin:this.props.isMobile?{top:15,right:25,bottom:30,left:25}:{top:30,right:50,bottom:60,left:50},onMouseEnter:function(t,e){var n=t.id,o=n?c.props.availableTokens[n]||c.functionsUtil.getGlobalConfig(["stats","tokens",n]):null;c.setState({selectedToken:n,selectedTokenConfig:o})},onMouseLeave:function(t,e){c.setState({selectedToken:null,selectedTokenConfig:null})},legends:[{itemWidth:60,itemHeight:18,translateY:this.props.isMobile?25:50,symbolSize:10,anchor:"bottom",direction:"row",itemTextColor:this.props.theme.colors.legend,symbolShape:"circle",effects:[{on:"hover",style:{itemTextColor:"#000"}}]}]},this.setState({portfolio:e,chartData:l,chartProps:r,totalFunds:n});case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=!(null===this.state.selectedToken||!this.state.portfolio[this.state.selectedToken])&&this.state.portfolio[this.state.selectedToken],e=this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"icon"]),n=!!this.state.selectedToken&&this.functionsUtil.getGlobalConfig(["stats","tokens",this.state.selectedToken,"conversionRateField"]);return p.a.createElement(d.h,{width:1},(this.state.totalFunds||t)&&p.a.createElement(d.h,{zIndex:0,top:["32%","35%"],left:["23%","27%"],textAlign:"center",alignItems:"center",width:["55%","46%"],position:"absolute",height:["40%","35%"],flexDirection:"column",justifyContent:"center"},t?p.a.createElement(p.a.Fragment,null,p.a.createElement(m.a,{fieldInfo:{name:"icon",props:{mb:1,height:"2.2em"}},token:this.state.selectedToken,tokenConfig:this.state.selectedTokenConfig}),p.a.createElement(k.a,{unitProps:{ml:2,fontSize:4,fontWeight:3},decimals:2,fontSize:[3,4],maxPrecision:5,fontWeight:[3,4],unit:n?"$":null,number:this.state.portfolio[this.state.selectedToken]}),p.a.createElement(d.u,{fontWeight:3,fontSize:[1,2],color:"cellTitle"},this.state.selectedToken)):p.a.createElement(p.a.Fragment,null,p.a.createElement(d.l,{mb:1,height:"2.2em",src:e}),p.a.createElement(k.a,{unit:"$",unitProps:{ml:2,fontSize:4,fontWeight:3},decimals:2,fontSize:[3,4],maxPrecision:5,fontWeight:[3,4],number:this.state.totalFunds}),p.a.createElement(d.u,{fontWeight:3,fontSize:[1,2],color:"cellTitle"},"Total funds"))),p.a.createElement(g.a,Object.assign({type:f.a,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:this.props.parentId,parentIdHeight:this.props.parentId})))}}]),e}(h.Component);e.default=v}}]);
//# sourceMappingURL=13.7d82b160.chunk.js.map